# ç³»ç»Ÿæ¶æ„æ–‡æ¡£ï¼šdeepwiki-rs â€”â€” æ™ºèƒ½ä»£ç åº“è‡ªåŠ¨åŒ–C4æ–‡æ¡£ç”Ÿæˆç³»ç»Ÿ

---

## 1. æ¶æ„æ¦‚è§ˆ (Architecture Overview)

### æ¶æ„è®¾è®¡ç†å¿µ

deepwiki-rs çš„æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯ **â€œä»¥å†…å­˜ä¸ºæ€»çº¿ï¼Œä»¥æ™ºèƒ½ä½“ä¸ºå•å…ƒï¼Œä»¥ç¼“å­˜ä¸ºå¼•æ“â€**ï¼Œæ„å»ºä¸€ä¸ª**é«˜å†…èšã€ä½è€¦åˆã€å¯æ‰©å±•ã€ä½æˆæœ¬**çš„è‡ªåŠ¨åŒ–æ¶æ„æ–‡æ¡£ç”Ÿæˆç³»ç»Ÿã€‚ç³»ç»Ÿæ‘’å¼ƒäº†ä¼ ç»Ÿâ€œå•ä½“å¼åˆ†æ+ç¡¬ç¼–ç æ¨¡æ¿â€çš„æ–‡æ¡£ç”Ÿæˆæ¨¡å¼ï¼Œè½¬è€Œé‡‡ç”¨**å¤šæ™ºèƒ½ä½“ååŒæ¶æ„ï¼ˆMulti-Agent Coordinationï¼‰**ï¼Œå°†å¤æ‚çš„æ¶æ„ç†è§£ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªèŒè´£å•ä¸€ã€å¯ç‹¬ç«‹æ¼”è¿›çš„æ™ºèƒ½ä½“ï¼ˆAgentï¼‰ï¼Œå¹¶é€šè¿‡**ç»Ÿä¸€å†…å­˜ä¸Šä¸‹æ–‡ï¼ˆMemory Contextï¼‰**å®ç°å¼‚æ­¥ã€æ— çŠ¶æ€çš„æ•°æ®ä¼ é€’ã€‚

è¯¥è®¾è®¡å®ç°äº†ä¸‰å¤§æ ¸å¿ƒç›®æ ‡ï¼š
1. **çŸ¥è¯†æŠ½è±¡åŒ–**ï¼šå°†åŸå§‹ä»£ç è½¬åŒ–ä¸ºç»“æ„åŒ–è¯­ä¹‰æ¨¡å‹ï¼ˆCodeInsightã€DomainModuleReportç­‰ï¼‰ï¼Œå®ç°ä»â€œä»£ç è¡Œâ€åˆ°â€œæ¶æ„æ„å›¾â€çš„è¯­ä¹‰è·ƒè¿ã€‚
2. **æˆæœ¬å¯æ§åŒ–**ï¼šé€šè¿‡ Prompt å“ˆå¸Œç¼“å­˜ä¸ Token ä¼°ç®—æœºåˆ¶ï¼Œå°†æ˜‚è´µçš„ LLM æ¨ç†æˆæœ¬é™ä½ 60%~85%ï¼Œå®ç°å¯é‡å¤ã€å¯å®¡è®¡çš„æ–‡æ¡£ç”Ÿæˆã€‚
3. **æ‰©å±•æŸ”æ€§åŒ–**ï¼šæ‰€æœ‰æ ¸å¿ƒæ¨¡å—ï¼ˆè¯­è¨€è§£æå™¨ã€LLM æä¾›å•†ã€è¾“å‡ºæ ¼å¼ï¼‰å‡é€šè¿‡æ¥å£æŠ½è±¡ï¼Œæ”¯æŒçƒ­æ’æ‹”ï¼Œæ»¡è¶³æœªæ¥å¤šè¯­è¨€ã€å¤šæ¨¡å‹ã€å¤šè¾“å‡ºæ ¼å¼çš„æ¼”è¿›éœ€æ±‚ã€‚

ç³»ç»Ÿéµå¾ª **â€œæ§åˆ¶æµ-æ•°æ®æµ-æœåŠ¡æµâ€ä¸‰æƒåˆ†ç«‹**åŸåˆ™ï¼š
- **æ§åˆ¶æµ**ï¼šç”± CLI å¯åŠ¨ï¼Œç»é…ç½®ä¸­å¿ƒè°ƒåº¦ï¼Œç”±ç¼–æ’å™¨ï¼ˆOrchestratorï¼‰é©±åŠ¨æµç¨‹ï¼›
- **æ•°æ®æµ**ï¼šå…¨éƒ¨é€šè¿‡å†…å­˜å­˜å‚¨åŸŸï¼ˆMemoryï¼‰ä¼ é€’ï¼Œå½¢æˆå”¯ä¸€å¯ä¿¡æ•°æ®æºï¼›
- **æœåŠ¡æµ**ï¼šLLMã€æ–‡ä»¶ç³»ç»Ÿã€ç¼“å­˜ç­‰ä½œä¸ºå¤–éƒ¨æœåŠ¡è¢«æŠ½è±¡ä¸ºå¯æ›¿æ¢çš„å·¥å…·å±‚ã€‚

### æ ¸å¿ƒæ¶æ„æ¨¡å¼

| æ¨¡å¼ | åº”ç”¨åœºæ™¯ | ä»·å€¼ |
|------|----------|------|
| **åˆ†å±‚æ¶æ„ï¼ˆLayered Architectureï¼‰** | ç”¨æˆ·å±‚ â†’ åŸºç¡€è®¾æ–½å±‚ â†’ æ ¸å¿ƒä¸šåŠ¡å±‚ â†’ è¾“å‡ºå±‚ | é™ä½è€¦åˆï¼Œæå‡å¯æµ‹è¯•æ€§ä¸å¯ç»´æŠ¤æ€§ |
| **ç®¡é“-è¿‡æ»¤å™¨ï¼ˆPipe-Filterï¼‰** | é¢„å¤„ç†â†’ç ”ç©¶â†’ç¼–æ’â†’è¾“å‡ºæµæ°´çº¿ | æ¨¡å—ç‹¬ç«‹ã€å¯å¹¶è¡Œã€å¯é‡ç”¨ |
| **å‘å¸ƒ-è®¢é˜…ï¼ˆPublish-Subscribeï¼‰** | æ™ºèƒ½ä½“é€šè¿‡å†…å­˜å­˜å‚¨è¯»å†™ä¸Šä¸‹æ–‡ | è§£è€¦ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…ï¼Œæ”¯æŒå¼‚æ­¥åä½œ |
| **ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰** | LLMæä¾›å•†é€‚é…å™¨ã€è¯­è¨€å¤„ç†å™¨ | æ”¯æŒæ’ä»¶åŒ–æ‰©å±•ï¼Œè¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢ |
| **ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰** | ç¼“å­˜ç®¡ç†å™¨ä»£ç†LLMè°ƒç”¨ | é€æ˜ä¼˜åŒ–ï¼Œæ— ä¾µå…¥å¼æ€§èƒ½å¢å¼º |
| **ç¼–æ’å™¨æ¨¡å¼ï¼ˆOrchestrator Patternï¼‰** | ResearchOrchestratorã€DocumentationComposer | é›†ä¸­æ§åˆ¶æµç¨‹ï¼Œè§£è€¦æ™ºèƒ½ä½“é€»è¾‘ |
| **å†…å­˜ä¸Šä¸‹æ–‡ï¼ˆIn-Memory Contextï¼‰** | GeneratorContext + ä½œç”¨åŸŸé”®ï¼ˆScope Keyï¼‰ | å”¯ä¸€æ•°æ®æ€»çº¿ï¼Œé¿å…å…¨å±€çŠ¶æ€æ±¡æŸ“ |

### æŠ€æœ¯æ ˆæ¦‚è¿°

| å±‚çº§ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|----------|------|
| **è¯­è¨€** | Rust 1.75+ | é›¶æˆæœ¬æŠ½è±¡ã€å†…å­˜å®‰å…¨ã€é«˜å¹¶å‘ã€ç¼–è¯‘æœŸæ£€æŸ¥ï¼Œé€‚åˆæ„å»ºé«˜æ€§èƒ½CLIå·¥å…· |
| **å¹¶å‘æ¨¡å‹** | async/await + tokio | éé˜»å¡I/Oï¼Œæ”¯æŒé«˜å¹¶å‘æ–‡ä»¶æ‰«æä¸LLMè¯·æ±‚ |
| **é…ç½®ç®¡ç†** | `config` crate + TOML + env | æ”¯æŒCLIã€ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶ä¸‰çº§ä¼˜å…ˆçº§åˆå¹¶ |
| **LLMäº¤äº’** | HTTP/REST + OpenAIå…¼å®¹åè®® | é€‚é… Moonshotã€Mistralã€OpenRouterã€Gemini ç­‰ä¸»æµæä¾›å•† |
| **ç¼“å­˜æœºåˆ¶** | æ–‡ä»¶ç³»ç»Ÿ + MD5å“ˆå¸Œé”® | æœ¬åœ°æŒä¹…åŒ–ç¼“å­˜ï¼Œæ”¯æŒè¿‡æœŸæ¸…ç†ï¼Œæ— å¤–éƒ¨ä¾èµ– |
| **æ•°æ®æ¨¡å‹** | Serde + è‡ªå®šä¹‰ç»“æ„ä½“ | æ‰€æœ‰ä¸Šä¸‹æ–‡æ•°æ®åºåˆ—åŒ–ä¸º JSONï¼Œæ”¯æŒè·¨æ¨¡å—ä¼ é€’ |
| **æ—¥å¿—ä¸ç›‘æ§** | `tracing` + `metrics` | è®°å½•ç¼“å­˜å‘½ä¸­ã€Tokenæ¶ˆè€—ã€æ‰§è¡Œè€—æ—¶ï¼Œæ”¯æŒ Prometheus æŒ‡æ ‡å¯¼å‡º |
| **æµ‹è¯•æ¡†æ¶** | `rstest` + `mockall` | æ”¯æŒå‚æ•°åŒ–æµ‹è¯•ä¸ Mock LLM å“åº”ï¼Œå®ç° 90%+ å•å…ƒæµ‹è¯•è¦†ç›–ç‡ |
| **æ„å»ºå·¥å…·** | Cargo + `cargo-make` | æ”¯æŒå¤šé˜¶æ®µæ„å»ºã€æ–‡æ¡£ç”Ÿæˆã€æ€§èƒ½åˆ†æä¸€ä½“åŒ– |

> âœ… **æ¶æ„å†³ç­–äº®ç‚¹**ï¼š  
> - **ä¸ä¾èµ–æ•°æ®åº“**ï¼šæ‰€æœ‰çŠ¶æ€é©»ç•™å†…å­˜ï¼Œé¿å…å¤æ‚è¿ç»´ï¼Œç¬¦åˆâ€œä¸€æ¬¡æ€§åˆ†æå·¥å…·â€å®šä½ã€‚  
> - **ä¸ä¾èµ–å¤–éƒ¨ç¼“å­˜æœåŠ¡**ï¼šç¼“å­˜æ–‡ä»¶å­˜å‚¨äºé¡¹ç›®æ ¹ç›®å½• `.deepwiki/cache/`ï¼Œè½»é‡ã€å¯ç‰ˆæœ¬æ§åˆ¶ã€‚  
> - **ä¸ä½¿ç”¨å¾®æœåŠ¡**ï¼šå•äºŒè¿›åˆ¶éƒ¨ç½²ï¼Œé¿å…ç½‘ç»œå»¶è¿Ÿä¸æœåŠ¡å‘ç°å¤æ‚æ€§ï¼Œç¬¦åˆ CLI å·¥å…·æœ¬è´¨ã€‚

---

## 2. ç³»ç»Ÿä¸Šä¸‹æ–‡ (System Context)

### ç³»ç»Ÿå®šä½ä¸ä»·å€¼

deepwiki-rs æ˜¯ä¸€æ¬¾é¢å‘**æŠ€æœ¯å›¢é˜Ÿ**çš„**è‡ªåŠ¨åŒ–æ¶æ„çŸ¥è¯†æ²‰æ·€å·¥å…·**ï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š

> **å°†æ²‰é»˜çš„ä»£ç åº“ï¼Œè½¬åŒ–ä¸ºå¯é˜…è¯»ã€å¯å®¡æŸ¥ã€å¯ä¼ æ‰¿çš„ç»“æ„åŒ–æ¶æ„æ–‡æ¡£ã€‚**

åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œæ¶æ„æ–‡æ¡£å¾€å¾€æ»åäºä»£ç æ¼”è¿›ï¼Œå¯¼è‡´æ–°æˆå‘˜ä¸Šæ‰‹æ…¢ã€é‡æ„é£é™©é«˜ã€æŠ€æœ¯å€ºç§¯ç´¯ã€‚deepwiki-rs é€šè¿‡è‡ªåŠ¨åŒ–åˆ†ææºç ä¸ READMEï¼Œç»“åˆå¤§è¯­è¨€æ¨¡å‹çš„è¯­ä¹‰ç†è§£èƒ½åŠ›ï¼Œ**åœ¨æ•°åˆ†é’Ÿå†…ç”Ÿæˆç¬¦åˆ C4 æ¨¡å‹æ ‡å‡†çš„å®Œæ•´æŠ€æœ¯æ–‡æ¡£é›†**ï¼Œæ˜¾è‘—é™ä½ï¼š

- æ–°æˆå‘˜å¹³å‡ä¸Šæ‰‹æ—¶é—´ï¼ˆä» 2~4 å‘¨ â†’ 1~3 å¤©ï¼‰
- æ¶æ„è¯„å®¡å‡†å¤‡æˆæœ¬ï¼ˆä» 5~10 å°æ—¶ â†’ 5 åˆ†é’Ÿï¼‰
- å› æ–‡æ¡£ç¼ºå¤±å¯¼è‡´çš„æ²Ÿé€šæ­§ä¹‰ä¸é‡å¤è°ƒç ”

ç³»ç»Ÿè¾“å‡ºçš„æ–‡æ¡£å¯ç›´æ¥ç”¨äºï¼š
- æŠ€æœ¯è¯„å®¡ä¼šè®®ææ–™
- é¡¹ç›®äº¤æ¥æ–‡æ¡£
- æ¶æ„å†³ç­–è®°å½•ï¼ˆADRï¼‰
- CI/CD æµç¨‹ä¸­çš„æ¶æ„ä¸€è‡´æ€§æ£€æŸ¥

### ç”¨æˆ·è§’è‰²ä¸åœºæ™¯

| ç”¨æˆ·è§’è‰² | éœ€æ±‚åœºæ™¯ | ä½¿ç”¨é¢‘ç‡ | è¾“å‡ºæ–‡æ¡£ä»·å€¼ |
|----------|----------|----------|----------------|
| **æ¶æ„å¸ˆ** | å¿«é€Ÿç†è§£é—ç•™ç³»ç»Ÿã€éªŒè¯æ¶æ„ä¸€è‡´æ€§ã€è¾“å‡ºäº¤ä»˜ç‰© | æ¯å‘¨ 1~2 æ¬¡ | ç³»ç»Ÿä¸Šä¸‹æ–‡å›¾ã€é¢†åŸŸæ¨¡å—å›¾ã€æ¶æ„å†³ç­–æ‘˜è¦ |
| **å¼€å‘å›¢é˜Ÿæˆå‘˜** | å¿«é€Ÿå®šä½æ¨¡å—è¾¹ç•Œã€ç†è§£ä¾èµ–å…³ç³»ã€è¾…åŠ©è°ƒè¯• | æ¯æ—¥ 1~3 æ¬¡ | æ¨¡å—æ´å¯Ÿæ–‡æ¡£ã€å·¥ä½œæµå›¾ã€å…³é”®ä»£ç è¯´æ˜ |
| **æŠ€æœ¯è´Ÿè´£äºº** | é‡åŒ–æŠ€æœ¯å€ºã€è¯„ä¼°æ–‡æ¡£è¦†ç›–ç‡ã€æ¨åŠ¨çŸ¥è¯†æ²‰æ·€ | æ¯æœˆ 1 æ¬¡ | æ€§èƒ½æ€»ç»“æŠ¥å‘Šã€TokenèŠ‚çœç»Ÿè®¡ã€å¤æ‚åº¦çƒ­åŠ›å›¾ |

> ğŸ“Œ **å…¸å‹åœºæ™¯**ï¼š  
> ä¸€ä½æ–°åŠ å…¥çš„åç«¯å·¥ç¨‹å¸ˆï¼Œæ‰§è¡Œ `deepwiki-rs analyze --path ./microservice`ï¼Œ10ç§’åè·å¾—åŒ…å«ï¼š
> - `system_context.md`ï¼šç³»ç»Ÿç›®æ ‡ã€ç”¨æˆ·ã€è¾¹ç•Œ
> - `domain_modules.md`ï¼šè®¢å•ã€æ”¯ä»˜ã€é€šçŸ¥ä¸‰å¤§é¢†åŸŸåŠå…¶ä¾èµ–
> - `workflow_core.md`ï¼šä¸‹å•â†’æ‰£æ¬¾â†’é€šçŸ¥çš„å®Œæ•´æµç¨‹å›¾
> - `modules/payment.md`ï¼šæ”¯ä»˜æ¨¡å—çš„ç±»å›¾ã€å…³é”®ç®—æ³•ã€å¼‚å¸¸å¤„ç†è·¯å¾„
> - `architecture_diagram.mermaid`ï¼šå®¹å™¨çº§ç»„ä»¶äº¤äº’å›¾
> 
> æ— éœ€é˜…è¯» 5000 è¡Œä»£ç ï¼Œå³å¯æŒæ¡ç³»ç»Ÿå…¨è²Œã€‚

### å¤–éƒ¨ç³»ç»Ÿäº¤äº’

| å¤–éƒ¨ç³»ç»Ÿ | äº¤äº’æ–¹å¼ | åè®®/æ¥å£ | ä¾èµ–å¼ºåº¦ | å®‰å…¨æ€§è€ƒè™‘ |
|----------|----------|-----------|----------|------------|
| **å¤§è¯­è¨€æ¨¡å‹æœåŠ¡**<br>ï¼ˆMoonshot / Mistral / OpenRouter / Geminiï¼‰ | HTTP API è°ƒç”¨ | RESTful JSON over HTTPS | é«˜ | API Key é€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥ï¼Œä¸å†™å…¥æ—¥å¿—ï¼›æ”¯æŒé‡è¯•ä¸é™çº§ |
| **æ–‡ä»¶ç³»ç»Ÿ**<br>ï¼ˆæœ¬åœ°ç£ç›˜ï¼‰ | æ–‡ä»¶è¯»å†™ | POSIX æ–‡ä»¶ç³»ç»Ÿ | é«˜ | æ”¯æŒç›¸å¯¹è·¯å¾„ã€ç¬¦å·é“¾æ¥ï¼›å†™å…¥å‰æ ¡éªŒæƒé™ï¼›é¿å…è·¯å¾„éå†æ”»å‡» |
| **ç¯å¢ƒå˜é‡ä¸é…ç½®æ–‡ä»¶** | é…ç½®åŠ è½½ | TOML + ENV | ä¸­ | é…ç½®æ–‡ä»¶æ”¯æŒ `.env` åŠ å¯†ï¼ˆé€šè¿‡ `dotenv`ï¼‰ï¼›æ•æ„Ÿå­—æ®µï¼ˆå¦‚ API Keyï¼‰ä¸è¢«åºåˆ—åŒ– |

> âš ï¸ **å®‰å…¨è®¾è®¡**ï¼š  
> - æ‰€æœ‰ LLM Prompt ä¸­çš„ä»£ç ç‰‡æ®µå‡ç»è¿‡**è¡Œæ•°æˆªæ–­**ï¼ˆé»˜è®¤ 200 è¡Œï¼‰ä¸**æ•æ„Ÿä¿¡æ¯è¿‡æ»¤**ï¼ˆå¦‚å¯†ç ã€å¯†é’¥æ­£åˆ™åŒ¹é…ï¼‰  
> - ç¼“å­˜æ–‡ä»¶é»˜è®¤ä¸åŒ…å«åŸå§‹ä»£ç ï¼Œä»…å­˜å‚¨åˆ†æç»“æœï¼ˆJSONï¼‰  
> - ä¸æ”¶é›†ç”¨æˆ·ä»£ç è‡³äº‘ç«¯ï¼Œæ‰€æœ‰å¤„ç†åœ¨æœ¬åœ°å®Œæˆ

### ç³»ç»Ÿè¾¹ç•Œå®šä¹‰

| åŒ…å«ç»„ä»¶ | æ’é™¤ç»„ä»¶ |
|----------|----------|
| âœ… CLI å…¥å£ (`cli.rs`, `main.rs`) | âŒ ç”¨æˆ· IDEï¼ˆå¦‚ VSCodeã€IntelliJï¼‰ |
| âœ… é…ç½®ç®¡ç† (`config.rs`) | âŒ æ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ |
| âœ… å†…å­˜å­˜å‚¨åŸŸ (`memory/mod.rs`) | âŒ CI/CD ç®¡é“ï¼ˆå¦‚ GitHub Actionsï¼‰ |
| âœ… LLM å®¢æˆ·ç«¯ä¸ ReAct æ‰§è¡Œå™¨ | âŒ LLM æœåŠ¡å†…éƒ¨æ¨¡å‹è®­ç»ƒï¼ˆå¦‚ Mistral è®­ç»ƒé›†ç¾¤ï¼‰ |
| âœ… å¤šè¯­è¨€å¤„ç†å™¨ï¼ˆRust/Python/JS...ï¼‰ | âŒ ä»£ç ç¼–è¯‘å™¨ï¼ˆå¦‚ rustcã€javacï¼‰ |
| âœ… ç ”ç©¶æ™ºèƒ½ä½“ï¼ˆç³»ç»Ÿä¸Šä¸‹æ–‡/é¢†åŸŸæ¨¡å—/å·¥ä½œæµï¼‰ | âŒ å…·ä½“å‡½æ•°å®ç°ç»†èŠ‚ï¼ˆå¦‚æŸä¸ªæ­£åˆ™è¡¨è¾¾å¼é€»è¾‘ï¼‰ |
| âœ… æ–‡æ¡£ç¼–æ’å™¨ï¼ˆMarkdown ç”Ÿæˆï¼‰ | âŒ æ–‡æ¡£æ¸²æŸ“å¼•æ“ï¼ˆå¦‚ Mermaid.js æ¸²æŸ“å™¨ï¼‰ |
| âœ… ç¼“å­˜ä¸æ€§èƒ½ç›‘æ§ | âŒ ç”¨æˆ·æœ¬åœ°ç½‘ç»œä»£ç†é…ç½®ï¼ˆå¦‚ proxychainsï¼‰ |
| âœ… è¾“å‡ºåŸŸï¼ˆæ–‡ä»¶å†™å…¥ï¼‰ | âŒ ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆå¦‚ Gitï¼‰ |

> ğŸ“Œ **ç³»ç»Ÿè¾¹ç•Œå“²å­¦**ï¼š  
> deepwiki-rs æ˜¯ä¸€ä¸ª**é»‘ç›’å¼ AI æ–‡æ¡£ç”Ÿæˆå™¨**ï¼Œå®ƒä¸å…³å¿ƒä»£ç å¦‚ä½•è¿è¡Œï¼Œåªå…³å¿ƒä»£ç å¦‚ä½•è¢«ç†è§£ã€‚å®ƒä¸æ›¿ä»£å¼€å‘è€…ï¼Œè€Œæ˜¯**æ”¾å¤§å¼€å‘è€…çš„è®¤çŸ¥å¸¦å®½**ã€‚

---

## 3. å®¹å™¨è§†å›¾ (Container View)

### é¢†åŸŸæ¨¡å—åˆ’åˆ†

ç³»ç»Ÿé‡‡ç”¨**é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDDDï¼‰æ€æƒ³**ï¼Œå°†åŠŸèƒ½åˆ’åˆ†ä¸º 7 ä¸ªæ ¸å¿ƒå®¹å™¨ï¼ˆContainerï¼‰ï¼ŒæŒ‰èŒè´£åˆ†ä¸ºä¸‰ç±»ï¼š

| ç±»åˆ« | å®¹å™¨åç§° | èŒè´£ | æ˜¯å¦æ ¸å¿ƒä¸šåŠ¡ |
|------|----------|------|----------------|
| **åŸºç¡€è®¾æ–½åŸŸ** | é…ç½®ç®¡ç†åŸŸ | åŠ è½½å¹¶åˆå¹¶ CLIã€ç¯å¢ƒå˜é‡ã€TOML é…ç½® | âœ… |
| | å†…å­˜å­˜å‚¨åŸŸ | ä½œä¸ºå”¯ä¸€æ•°æ®æ€»çº¿ï¼Œå­˜å‚¨æ‰€æœ‰åˆ†æä¸Šä¸‹æ–‡ | âœ… |
| **å·¥å…·æ”¯æ’‘åŸŸ** | LLMå®¢æˆ·ç«¯åŸŸ | æŠ½è±¡ LLM æœåŠ¡ï¼Œæä¾› ReAct æ¨ç†ã€Token ä¼°ç®— | âœ… |
| | ç¼“å­˜åŸŸ | åŸºäº Prompt å“ˆå¸Œç¼“å­˜ LLM ç»“æœï¼Œç›‘æ§æ€§èƒ½ | âœ… |
| | å·¥å…·æ”¯æ’‘åŸŸ | æ–‡ä»¶æ¢ç´¢ã€è¯»å–ã€æºç æå–ã€å¹¶å‘æ§åˆ¶ | âœ… |
| **æ ¸å¿ƒä¸šåŠ¡åŸŸ** | é¢„å¤„ç†åŸŸ | æ‰«æé¡¹ç›®ç»“æ„ï¼Œæå–ä»£ç å…ƒæ•°æ®ï¼Œç”Ÿæˆ CodeInsight | âœ… |
| | ç ”ç©¶åŸŸ | å¤šæ™ºèƒ½ä½“ååŒåˆ†æç³»ç»Ÿä¸Šä¸‹æ–‡ã€é¢†åŸŸæ¨¡å—ã€å·¥ä½œæµ | âœ… |
| | æ–‡æ¡£ç¼–æ’åŸŸ | å°†ç ”ç©¶ç»“æœç¼–æ’ä¸ºæ ‡å‡†åŒ– C4 æ–‡æ¡£ | âœ… |
| | è¾“å‡ºåŸŸ | å°†æ–‡æ¡£æŒä¹…åŒ–è‡³æ–‡ä»¶ç³»ç»Ÿï¼Œç”Ÿæˆæ€»ç»“æŠ¥å‘Š | âœ… |

> âœ… **å…³é”®è®¾è®¡**ï¼šæ‰€æœ‰æ ¸å¿ƒä¸šåŠ¡åŸŸï¼ˆé¢„å¤„ç†ã€ç ”ç©¶ã€ç¼–æ’ï¼‰**ä¸ç›´æ¥é€šä¿¡**ï¼Œä»…é€šè¿‡**å†…å­˜å­˜å‚¨åŸŸ**äº¤æ¢æ•°æ®ï¼Œå®ç°çœŸæ­£çš„ä½è€¦åˆã€‚

### å®¹å™¨æ¶æ„å›¾ï¼ˆMermaidï¼‰

```mermaid
graph TD
    %% ==================== ç”¨æˆ·å±‚ ====================
    A[CLI å‘½ä»¤è¡Œå…¥å£] --> B[é…ç½®ç®¡ç†åŸŸ]

    %% ==================== åŸºç¡€è®¾æ–½åŸŸ ====================
    subgraph "åŸºç¡€è®¾æ–½åŸŸ"
        B --> C[å†…å­˜å­˜å‚¨åŸŸ]
        B --> D[LLMå®¢æˆ·ç«¯åŸŸ]
        B --> E[ç¼“å­˜åŸŸ]
        B --> F[å·¥å…·æ”¯æ’‘åŸŸ]
    end

    %% ==================== å·¥å…·æ”¯æ’‘åŸŸ ====================
    subgraph "å·¥å…·æ”¯æ’‘åŸŸ"
        F --> F1[æ–‡ä»¶æ¢ç´¢å·¥å…·]
        F --> F2[æ–‡ä»¶è¯»å–å·¥å…·]
        F --> F3[æºç æå–å™¨]
        F --> F4[å¹¶å‘æ§åˆ¶å™¨]
        F --> F5[é¡¹ç›®ç»“æ„æ ¼å¼åŒ–å™¨]
    end

    %% ==================== ç¼“å­˜åŸŸ ====================
    subgraph "ç¼“å­˜åŸŸ"
        E --> E1[ç¼“å­˜ç®¡ç†å™¨]
        E --> E2[æ€§èƒ½ç›‘æ§å™¨]
    end

    %% ==================== LLMå®¢æˆ·ç«¯åŸŸ ====================
    subgraph "LLMå®¢æˆ·ç«¯åŸŸ"
        D --> D1[æä¾›å•†é€‚é…å™¨]
        D --> D2[ReActæ‰§è¡Œå™¨]
        D --> D3[èµ„æºä¼°ç®—å™¨]
        D1 --> M[å¤§è¯­è¨€æ¨¡å‹æœåŠ¡<br>Moonshot/Mistral/OpenRouter...]
        D2 --> D1
        D3 --> E1
    end

    %% ==================== æ ¸å¿ƒä¸šåŠ¡åŸŸ ====================
    subgraph "æ ¸å¿ƒä¸šåŠ¡åŸŸ"
        C --> H[é¢„å¤„ç†åŸŸ]
        C --> I[ç ”ç©¶åŸŸ]
        C --> J[æ–‡æ¡£ç¼–æ’åŸŸ]
        C --> K[è¾“å‡ºåŸŸ]
    end

    %% ==================== é¢„å¤„ç†åŸŸ ====================
    subgraph "é¢„å¤„ç†åŸŸ"
        H --> H1[ç»“æ„æ‰«æå™¨]
        H --> H2[è¯­è¨€å¤„ç†å™¨ç®¡ç†å™¨]
        H --> H3[AIåˆ†æä»£ç†]
        H1 --> F1
        H2 --> F3
        H2 --> H2_1[RustProcessor]
        H2 --> H2_2[PythonProcessor]
        H2 --> H2_3[JavaScriptProcessor]
        H2 --> H2_4[TypeScriptProcessor]
        H2 --> H2_5[JavaProcessor]
        H2 --> H2_6[KotlinProcessor]
        H2 --> H2_7[VueProcessor]
        H2 --> H2_8[ReactProcessor]
        H2 --> H2_9[SvelteProcessor]
        H3 --> D2
    end

    %% ==================== ç ”ç©¶åŸŸ ====================
    subgraph "ç ”ç©¶åŸŸ"
        I --> I1[ç ”ç©¶ç¼–æ’å™¨]
        I1 --> I2[ç³»ç»Ÿä¸Šä¸‹æ–‡åˆ†æå™¨]
        I1 --> I3[é¢†åŸŸæ¨¡å—æ¢æµ‹å™¨]
        I1 --> I4[å·¥ä½œæµåˆ†æå™¨]
        I1 --> I5[å…³é”®æ¨¡å—æ´å¯Ÿå™¨]
        I1 --> I6[æ¶æ„å›¾ç”Ÿæˆå™¨]
        I2 --> D2
        I3 --> D2
        I4 --> D2
        I5 --> D2
        I6 --> D2
    end

    %% ==================== æ–‡æ¡£ç¼–æ’åŸŸ ====================
    subgraph "æ–‡æ¡£ç¼–æ’åŸŸ"
        J --> J1[æ–‡æ¡£ç¼–æ’ä¸­æ¢]
        J1 --> J2[é¡¹ç›®æ¦‚è¿°ç¼–è¾‘å™¨]
        J1 --> J3[æ¶æ„è¯´æ˜ç¼–è¾‘å™¨]
        J1 --> J4[æ ¸å¿ƒæµç¨‹ç¼–è¾‘å™¨]
        J1 --> J5[æ¨¡å—æ´å¯Ÿç¼–è¾‘å™¨]
        J2 --> D2
        J3 --> D2
        J4 --> D2
        J5 --> D2
    end

    %% ==================== è¾“å‡ºåŸŸ ====================
    subgraph "è¾“å‡ºåŸŸ"
        K --> K1[æ–‡æ¡£è¾“å‡ºå™¨]
        K --> K2[æ€»ç»“æŠ¥å‘Šç”Ÿæˆå™¨]
        K1 --> L[æ–‡ä»¶ç³»ç»Ÿ]
        K2 --> L
    end

    %% ==================== æ•°æ®æµï¼ˆä¸»æµç¨‹ï¼‰ ====================
    A --> B
    B --> N[æ–‡ä»¶ç³»ç»Ÿ]
    N --> H1
    H1 --> H2
    H2 --> H3
    H3 --> C
    C --> I1
    I1 --> I2
    I2 --> D2
    D2 --> C
    I1 --> I3
    I3 --> D2
    D2 --> C
    I1 --> I4
    I4 --> D2
    D2 --> C
    I1 --> I5
    I5 --> D2
    D2 --> C
    I1 --> I6
    I6 --> D2
    D2 --> C
    C --> J1
    J1 --> J2
    J2 --> D2
    D2 --> C
    J1 --> J3
    J3 --> D2
    D2 --> C
    J1 --> J4
    J4 --> D2
    D2 --> C
    J1 --> J5
    J5 --> D2
    D2 --> C
    C --> K1
    C --> K2
    K2 --> E2
    E2 --> L

    %% ==================== ç¼“å­˜ä¼˜åŒ–æµ ====================
    D2 --> E1
    E1 --> D2
    E2 --> E1

    %% ==================== æ ·å¼å®šä¹‰ ====================
    classDef user fill:#4CAF50,stroke:#388E3C,stroke-width:2px,color:white;
    classDef infrastructure fill:#2196F3,stroke:#1976D2,stroke-width:2px,color:white;
    classDef tool fill:#9E9E9E,stroke:#616161,stroke-width:2px;
    classDef coreBusiness fill:#FFC107,stroke:#FFA000,stroke-width:2px;
    classDef llm fill:#E91E63,stroke:#C2185B,stroke-width:2px,color:white;
    classDef cache fill:#673AB7,stroke:#5E35B1,stroke-width:2px,color:white;
    classDef external fill:#FF9800,stroke:#F57C00,stroke-width:2px;

    class A user
    class B,C,D,E,F infrastructure
    class H,I,J,K coreBusiness
    class D2 llm
    class E1,E2 cache
    class M,N,L external
    class F1,F2,F3,F4,F5 tool
```

### å­˜å‚¨è®¾è®¡

| å­˜å‚¨ç±»å‹ | ä½ç½® | æ•°æ®å†…å®¹ | ç”Ÿå‘½å‘¨æœŸ | è®¿é—®æ–¹å¼ |
|----------|------|----------|----------|----------|
| **å†…å­˜å­˜å‚¨ï¼ˆä¸»å­˜å‚¨ï¼‰** | è¿›ç¨‹å †å†…å­˜ | `CodeInsight`ã€`DomainModuleReport`ã€`WorkflowReport`ã€`DocTree` ç­‰ç»“æ„åŒ–ä¸Šä¸‹æ–‡ | ä»…è¿è¡Œæ—¶å­˜åœ¨ï¼Œè¿›ç¨‹é€€å‡ºå³é”€æ¯ | é€šè¿‡ `GeneratorContext`ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰å¼‚æ­¥è¯»å†™ |
| **ç¼“å­˜å­˜å‚¨ï¼ˆæŒä¹…åŒ–ï¼‰** | `.deepwiki/cache/` ç›®å½• | JSON æ–‡ä»¶ï¼Œé”®ä¸º `prompt_md5`ï¼Œå€¼ä¸º `LLMå“åº” + token_usage + timestamp` | é»˜è®¤ 7 å¤©è¿‡æœŸï¼Œæ”¯æŒæ‰‹åŠ¨æ¸…ç† | é€šè¿‡ `CacheManager` è¯»å†™ï¼Œæ”¯æŒå¹¶å‘ |
| **è¾“å‡ºå­˜å‚¨ï¼ˆæŒä¹…åŒ–ï¼‰** | `./docs/` æˆ–æŒ‡å®šè·¯å¾„ | Markdown æ–‡ä»¶ï¼ˆ`.md`ï¼‰ã€Mermaid å›¾ï¼ˆ`.mermaid`ï¼‰ã€JSON æ€»ç»“æŠ¥å‘Š | æŒä¹…åŒ–ï¼Œå¯æäº¤è‡³ Git | é€šè¿‡ `DiskOutlet` å†™å…¥ |

> âœ… **è®¾è®¡æ´å¯Ÿ**ï¼š  
> å†…å­˜æ˜¯â€œ**åˆ†æè¿‡ç¨‹çš„ä¸´æ—¶çŠ¶æ€**â€ï¼Œç¼“å­˜æ˜¯â€œ**æ¨ç†ç»“æœçš„å¤ç”¨å‰¯æœ¬**â€ï¼Œè¾“å‡ºæ˜¯â€œ**æœ€ç»ˆäº¤ä»˜ç‰©**â€ã€‚ä¸‰è€…åˆ†ç¦»ï¼Œé¿å…çŠ¶æ€æ±¡æŸ“ã€‚

### é¢†åŸŸæ¨¡å—é—´é€šä¿¡

æ‰€æœ‰æ¨¡å—é—´é€šä¿¡**ä»…é€šè¿‡å†…å­˜å­˜å‚¨åŸŸ**ï¼Œå½¢æˆ**å•ä¸€æ•°æ®æºï¼ˆSingle Source of Truthï¼‰**ï¼š

```mermaid
graph LR
    A[é¢„å¤„ç†åŸŸ] -->|å†™å…¥| C[å†…å­˜å­˜å‚¨åŸŸ]
    B[ç ”ç©¶åŸŸ] -->|è¯»å–| C
    B -->|å†™å…¥| C
    D[æ–‡æ¡£ç¼–æ’åŸŸ] -->|è¯»å–| C
    D -->|å†™å…¥| C
    E[è¾“å‡ºåŸŸ] -->|è¯»å–| C
    F[LLMå®¢æˆ·ç«¯åŸŸ] -->|è¯»å–| C
    F -->|å†™å…¥| C
    G[ç¼“å­˜åŸŸ] -->|è¯»å–| C
    G -->|å†™å…¥| C

    style C fill:#2196F3,stroke:#1976D2,stroke-width:2px,color:white
    style A,B,D,E,F,G fill:#FFC107,stroke:#FFA000,stroke-width:2px
```

- **é€šä¿¡åè®®**ï¼šåŸºäº `String` é”®å + `serde_json::Value` å€¼ï¼Œæ”¯æŒä»»æ„ç»“æ„ä½“åºåˆ—åŒ–ã€‚
- **ä½œç”¨åŸŸéš”ç¦»**ï¼šé€šè¿‡ `Scope`ï¼ˆå¦‚ `STUDIES_RESEARCH`ã€`DOCUMENTATION`ï¼‰é¿å…é”®å†²çªã€‚
- **çº¿ç¨‹å®‰å…¨**ï¼šå†…å­˜å­˜å‚¨ä½¿ç”¨ `Arc<Mutex<T>>` + `tokio::sync::RwLock` å®ç°å¹¶å‘è¯»å†™ã€‚
- **æ— ç›´æ¥ä¾èµ–**ï¼šç ”ç©¶åŸŸä¸ä¾èµ–é¢„å¤„ç†åŸŸï¼Œä»…ä¾èµ–å†…å­˜ä¸­çš„ `CodeInsight`ï¼Œå®ç°**æ¥å£éš”ç¦»**ã€‚

> ğŸ’¡ **æ¶æ„ä¼˜åŠ¿**ï¼š  
> æ–°å¢ä¸€ä¸ªâ€œå®‰å…¨å®¡è®¡æ™ºèƒ½ä½“â€åªéœ€ï¼š
> 1. å®ç° `Agent` traitï¼›
> 2. ä»å†…å­˜è¯»å– `CodeInsight`ï¼›
> 3. å†™å…¥ `SecurityAuditReport`ï¼›
> 4. åœ¨ç¼–æ’å™¨ä¸­æ³¨å†Œï¼›
> æ— éœ€ä¿®æ”¹ä»»ä½•å…¶ä»–æ¨¡å—ï¼

---

## 4. ç»„ä»¶è§†å›¾ (Component View)

### æ ¸å¿ƒåŠŸèƒ½ç»„ä»¶

#### 1. é¢„å¤„ç†åŸŸï¼ˆPreprocess Domainï¼‰

| ç»„ä»¶ | èŒè´£ | å…³é”®å®ç° |
|------|------|----------|
| **ç»“æ„æ‰«æå™¨** | é€’å½’éå†é¡¹ç›®ç›®å½•ï¼Œè®¡ç®—æ–‡ä»¶é‡è¦æ€§åˆ†æ•°ï¼Œè¿‡æ»¤ `.git`ã€`node_modules` ç­‰ | ä½¿ç”¨ `walkdir` + è‡ªå®šä¹‰ `ImportanceScore` ç®—æ³•ï¼ˆåŸºäºæ–‡ä»¶å¤§å°ã€å¼•ç”¨æ¬¡æ•°ã€README å…³è”ï¼‰ |
| **è¯­è¨€å¤„ç†å™¨ç®¡ç†å™¨** | æ ¹æ®æ–‡ä»¶æ‰©å±•ååŒ¹é…å¯¹åº”å¤„ç†å™¨ï¼Œæ”¯æŒ 10+ è¯­è¨€ | ä½¿ç”¨ `HashMap<String, Box<dyn LanguageProcessor>>` å®ç°æ’ä»¶æ³¨å†Œ |
| **RustProcessor** | è§£æ `mod.rs`ã€`struct`ã€`impl`ã€`use`ï¼Œæå–æ¨¡å—ä¾èµ–ã€å…¬å…±æ¥å£ | ä½¿ç”¨ `syn` + `quote` è§£æ ASTï¼Œæ„å»º `DependencyGraph` |
| **PythonProcessor** | è§£æ `import`ã€`class`ã€`def`ï¼Œè¯†åˆ«æ¨¡å—å±‚çº§ä¸æ¥å£ | ä½¿ç”¨ `ast` æ¨¡å— + è‡ªå®šä¹‰éå†å™¨ |
| **AIåˆ†æä»£ç†** | è°ƒç”¨ LLM å¯¹ä»£ç è¿›è¡Œè¯­ä¹‰å¢å¼ºï¼šç”¨é€”åˆ†ç±»ã€å…³ç³»å›¾è°±ã€å…³é”®è¡Œè¯†åˆ« | å°è£… `code_analyze`, `code_purpose_analyze`, `relationships_analyze` ä¸‰ä¸ª Prompt æ¨¡æ¿ |

#### 2. ç ”ç©¶åŸŸï¼ˆResearch Domainï¼‰

| ç»„ä»¶ | èŒè´£ | å…³é”®å®ç° |
|------|------|----------|
| **ç ”ç©¶ç¼–æ’å™¨** | æŒ‰é¡ºåºè°ƒç”¨ 6 ä¸ªæ™ºèƒ½ä½“ï¼Œå¤„ç†é”™è¯¯ä¼ æ’­ä¸è¶…æ—¶ | ä½¿ç”¨ `async fn execute_research_pipeline()` + `futures::future::join_all` |
| **ç³»ç»Ÿä¸Šä¸‹æ–‡åˆ†æå™¨** | ä» READMEã€Cargo.tomlã€é¡¹ç›®ç»“æ„æ¨æ–­ç³»ç»Ÿç›®æ ‡ã€ç”¨æˆ·ã€è¾¹ç•Œ | Prompt æ¨¡æ¿ï¼š`â€œä½ æ˜¯ä¸€ä¸ªæ¶æ„å¸ˆï¼Œè¯·æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ç”Ÿæˆç³»ç»Ÿä¸Šä¸‹æ–‡å›¾ï¼š...â€` |
| **é¢†åŸŸæ¨¡å—æ¢æµ‹å™¨** | è¯†åˆ«åŠŸèƒ½é¢†åŸŸï¼ˆå¦‚â€œè®¢å•â€ã€â€œæ”¯ä»˜â€ï¼‰ï¼Œå¹¶åˆ’åˆ†å…¶å†…éƒ¨æ¨¡å— | ä½¿ç”¨èšç±»ç®—æ³•ï¼šåŸºäºä¾èµ–å›¾è°±çš„è¿é€šåˆ†é‡ + LLM è¯­ä¹‰èšç±» |
| **å·¥ä½œæµåˆ†æå™¨** | æå–æ ¸å¿ƒä¸šåŠ¡æµç¨‹ï¼ˆå¦‚â€œç”¨æˆ·ä¸‹å•â€ï¼‰ï¼Œç”Ÿæˆ Mermaid æµç¨‹å›¾ | ä» `main.rs`ã€`controller/`ã€`service/` ä¸­æå–å…¥å£å‡½æ•°ï¼Œæ„å»ºè°ƒç”¨é“¾ |
| **å…³é”®æ¨¡å—æ´å¯Ÿå™¨** | ä¸ºæ¯ä¸ªé¢†åŸŸæ¨¡å—ç”ŸæˆæŠ€æœ¯æ–‡æ¡£ï¼šå®ç°ç»†èŠ‚ã€è®¾è®¡å†³ç­–ã€æŠ€æœ¯å€º | é€æ¨¡å—è°ƒç”¨ LLMï¼šâ€œè¯·åˆ†æ `payment/` æ¨¡å—çš„æ¶æ„å†³ç­–ä¸æ½œåœ¨é£é™©â€ |
| **æ¶æ„å›¾ç”Ÿæˆå™¨** | ç”Ÿæˆå®¹å™¨çº§ä¸ç»„ä»¶çº§ Mermaid å›¾ | åŸºäº `DependencyGraph` + `ComponentType` ç”Ÿæˆ `graph TD` è¯­æ³• |

#### 3. æ–‡æ¡£ç¼–æ’åŸŸï¼ˆDocumentation Domainï¼‰

| ç»„ä»¶ | èŒè´£ | å…³é”®å®ç° |
|------|------|----------|
| **æ–‡æ¡£ç¼–æ’ä¸­æ¢** | åè°ƒ 4 ä¸ªç¼–è¾‘å™¨æŒ‰é¡ºåºæ‰§è¡Œï¼Œç¡®ä¿ä¾èµ–å®Œæ•´æ€§ | ä½¿ç”¨ `compose_documentation()` é“¾å¼è°ƒç”¨ï¼Œå¤±è´¥æ—¶å›æ»š |
| **é¡¹ç›®æ¦‚è¿°ç¼–è¾‘å™¨** | åˆå¹¶ç³»ç»Ÿä¸Šä¸‹æ–‡æŠ¥å‘Šä¸ READMEï¼Œç”Ÿæˆ `system_context.md` | æ¨¡æ¿ï¼š`# ç³»ç»Ÿä¸Šä¸‹æ–‡\n\n## ç›®æ ‡\n{{system_goal}}\n\n## ç”¨æˆ·\n{{users}}` |
| **æ¶æ„è¯´æ˜ç¼–è¾‘å™¨** | ç”Ÿæˆå®¹å™¨å›¾ï¼ˆContainer Diagramï¼‰ä¸ç»„ä»¶å›¾ï¼ˆComponent Diagramï¼‰ | ä½¿ç”¨ `MermaidRenderer`ï¼Œå°† `DependencyGraph` è½¬æ¢ä¸º `graph TD` |
| **æ ¸å¿ƒæµç¨‹ç¼–è¾‘å™¨** | ç”Ÿæˆä¸šåŠ¡æµç¨‹å›¾ï¼Œå¦‚â€œä¸‹å•â†’æ‰£æ¬¾â†’é€šçŸ¥â€ | ä» `WorkflowReport` æå–æ­¥éª¤ï¼Œç”Ÿæˆ `sequenceDiagram` |
| **æ¨¡å—æ´å¯Ÿç¼–è¾‘å™¨** | ä¸ºæ¯ä¸ªæ¨¡å—ç”Ÿæˆç‹¬ç«‹æ–‡æ¡£ï¼ŒåŒ…å«ç±»å›¾ã€å…³é”®å‡½æ•°ã€å¼‚å¸¸å¤„ç† | æ¨¡æ¿ä¸­åµŒå…¥ `CodeInsight` çš„ `important_lines` ä¸ `comments` |

#### 4. è¾“å‡ºåŸŸï¼ˆOutlet Domainï¼‰

| ç»„ä»¶ | èŒè´£ | å…³é”®å®ç° |
|------|------|----------|
| **æ–‡æ¡£è¾“å‡ºå™¨** | å°† `DocTree` ä¸­çš„æ–‡æ¡£æŒ‰è·¯å¾„å†™å…¥ç£ç›˜ | ä½¿ç”¨ `tokio::fs::create_dir_all` + `tokio::fs::write`ï¼Œæ”¯æŒå¹¶å‘å†™å…¥ |
| **æ€»ç»“æŠ¥å‘Šç”Ÿæˆå™¨** | èšåˆç¼“å­˜å‘½ä¸­ç‡ã€TokenèŠ‚çœã€æ‰§è¡Œè€—æ—¶ï¼Œç”Ÿæˆ `summary.json` | ä½¿ç”¨ `PerformanceMonitor` çš„ç»Ÿè®¡ç»“æœï¼Œç”Ÿæˆ Markdown + JSON åŒæ ¼å¼ |

### æŠ€æœ¯æ”¯æ’‘ç»„ä»¶

| ç»„ä»¶ | èŒè´£ | å…³é”®å®ç° |
|------|------|----------|
| **LLMå®¢æˆ·ç«¯åŸŸ** | | |
| - æä¾›å•†é€‚é…å™¨ | å°è£… Moonshotã€Mistralã€OpenRouter ç­‰ API å·®å¼‚ | ä½¿ç”¨ `enum LlmProvider { Moonshot, Mistral, OpenRouter }` + `impl LlmClient for Each` |
| - ReActæ‰§è¡Œå™¨ | å®ç°å¤šè½®æ¨ç†ï¼šæ€è€ƒâ†’å·¥å…·è°ƒç”¨â†’åæ€â†’ç»ˆæ­¢ | ä½¿ç”¨ `ReActState` ç»“æ„ä½“ï¼Œç»´æŠ¤ `thoughts`ã€`actions`ã€`observations` |
| - èµ„æºä¼°ç®—å™¨ | é¢„ä¼° Prompt Token æ•°é‡ï¼Œæ¨èæœ€ä¼˜æ¨¡å‹ | ä½¿ç”¨ `tiktoken_rs` + è‡ªå®šä¹‰è¯å…ƒç»Ÿè®¡è§„åˆ™ |
| **ç¼“å­˜åŸŸ** | | |
| - ç¼“å­˜ç®¡ç†å™¨ | åŸºäº Prompt MD5 å“ˆå¸Œç¼“å­˜ç»“æœï¼Œæ”¯æŒè¿‡æœŸæ¸…ç† | ä½¿ç”¨ `std::fs::read_dir` + `serde_json::from_str`ï¼ŒLRU æ¸…ç†ç­–ç•¥ |
| - æ€§èƒ½ç›‘æ§å™¨ | æ— é”è®°å½•å‘½ä¸­/æœªå‘½ä¸­ï¼Œè®¡ç®—èŠ‚çœæˆæœ¬ | ä½¿ç”¨ `AtomicUsize` + `Instant`ï¼Œæ¯ 100 æ¬¡è°ƒç”¨è¾“å‡ºæŠ¥å‘Š |
| **å·¥å…·æ”¯æ’‘åŸŸ** | | |
| - æ–‡ä»¶æ¢ç´¢å·¥å…· | é€’å½’æ‰«æï¼Œæ”¯æŒæ­£åˆ™è¿‡æ»¤ | ä½¿ç”¨ `walkdir` + `ignore` crate |
| - æ–‡ä»¶è¯»å–å·¥å…· | å®‰å…¨è¯»å–ï¼Œé¿å…äºŒè¿›åˆ¶æ–‡ä»¶ | æ£€æŸ¥ `is_utf8()`ï¼Œé™åˆ¶æœ€å¤§è¡Œæ•°ï¼ˆ500ï¼‰ |
| - æºç æå–å™¨ | æ™ºèƒ½æˆªå–å…³é”®ä»£ç æ®µ | åŸºäº `CodeInsight.important_lines` æˆªå–å‰å 10 è¡Œ |
| - å¹¶å‘æ§åˆ¶å™¨ | é™åˆ¶å¹¶å‘ LLM è¯·æ±‚ï¼ˆé»˜è®¤ 5ï¼‰ | ä½¿ç”¨ `tokio::sync::Semaphore` |

### ç»„ä»¶äº¤äº’å…³ç³»

```mermaid
graph TD
    A[CLI] --> B[é…ç½®ç®¡ç†]
    B --> C[å†…å­˜å­˜å‚¨]
    B --> D[LLMå®¢æˆ·ç«¯]
    B --> E[ç¼“å­˜]
    B --> F[å·¥å…·æ”¯æ’‘]

    F --> G[é¢„å¤„ç†åŸŸ]
    G --> C
    C --> H[ç ”ç©¶åŸŸ]
    H --> D
    D --> E
    C --> I[æ–‡æ¡£ç¼–æ’åŸŸ]
    I --> D
    C --> J[è¾“å‡ºåŸŸ]
    J --> K[æ–‡ä»¶ç³»ç»Ÿ]
    E --> J

    style A fill:#4CAF50
    style B,C,D,E,F fill:#2196F3
    style G,H,I fill:#FFC107
    style J fill:#9E9E9E
    style K fill:#FF9800
    style D fill:#E91E63
    style E fill:#673AB7
```

> âœ… **äº¤äº’åŸåˆ™**ï¼š
> - æ‰€æœ‰ä¸šåŠ¡ç»„ä»¶ï¼ˆé¢„å¤„ç†ã€ç ”ç©¶ã€ç¼–æ’ï¼‰**åªè¯»å†™å†…å­˜**ï¼Œä¸ç›´æ¥è°ƒç”¨å…¶ä»–ç»„ä»¶
> - LLM å®¢æˆ·ç«¯æ˜¯**å”¯ä¸€å¤–éƒ¨æœåŠ¡è°ƒç”¨è€…**ï¼Œè¢«æ‰€æœ‰æ™ºèƒ½ä½“é€šè¿‡ç¼“å­˜ä»£ç†è®¿é—®
> - ç¼“å­˜æ˜¯**é€æ˜ä¼˜åŒ–å±‚**ï¼Œå¯¹è°ƒç”¨æ–¹æ— æ„ŸçŸ¥

---

## 5. å…³é”®æµç¨‹ (Key Processes)

### æ ¸å¿ƒåŠŸèƒ½æµç¨‹ï¼šé¡¹ç›®åˆ†æä¸æ–‡æ¡£ç”Ÿæˆ

```mermaid
graph TD
    A[CLIå‘½ä»¤è¡Œå¯åŠ¨] --> B[é…ç½®ç®¡ç†åŸŸï¼šåŠ è½½å¹¶åˆå¹¶é…ç½®]
    B --> C[é¢„å¤„ç†åŸŸï¼šæ‰«æé¡¹ç›®ç»“æ„ä¸README]
    C --> D[é¢„å¤„ç†åŸŸï¼šè¯­è¨€å¤„ç†å™¨æå–ä»£ç å…ƒæ•°æ®]
    D --> E[é¢„å¤„ç†åŸŸï¼šAIä»£ç†ç”Ÿæˆä»£ç æ´å¯Ÿ]
    E --> F[ç ”ç©¶åŸŸï¼šç¼–æ’å™¨å¯åŠ¨å¤šæ™ºèƒ½ä½“åˆ†æ]
    F --> G[ç ”ç©¶åŸŸï¼šç³»ç»Ÿä¸Šä¸‹æ–‡åˆ†æ]
    G --> H[ç ”ç©¶åŸŸï¼šé¢†åŸŸæ¨¡å—æ¢æµ‹]
    H --> I[ç ”ç©¶åŸŸï¼šæ ¸å¿ƒå·¥ä½œæµåˆ†æ]
    I --> J[ç ”ç©¶åŸŸï¼šå…³é”®æ¨¡å—æ´å¯Ÿ]
    J --> K[ç ”ç©¶åŸŸï¼šæ¶æ„å›¾ç”Ÿæˆ]
    K --> L[æ–‡æ¡£ç¼–æ’åŸŸï¼šç¼–æ’ä¸­æ¢åè°ƒå››å¤§ç¼–è¾‘å™¨]
    L --> M[æ–‡æ¡£ç¼–æ’åŸŸï¼šç”Ÿæˆé¡¹ç›®æ¦‚è¿°æ–‡æ¡£]
    M --> N[æ–‡æ¡£ç¼–æ’åŸŸï¼šç”Ÿæˆæ¶æ„å›¾æ–‡æ¡£]
    N --> O[æ–‡æ¡£ç¼–æ’åŸŸï¼šç”Ÿæˆæ ¸å¿ƒå·¥ä½œæµæ–‡æ¡£]
    O --> P[æ–‡æ¡£ç¼–æ’åŸŸï¼šç”Ÿæˆæ¨¡å—æ´å¯Ÿæ–‡æ¡£]
    P --> Q[è¾“å‡ºåŸŸï¼šæŒä¹…åŒ–æ‰€æœ‰æ–‡æ¡£åˆ°æ–‡ä»¶ç³»ç»Ÿ]
    Q --> R[è¾“å‡ºåŸŸï¼šç”Ÿæˆé¡¹ç›®æ€»ç»“æŠ¥å‘Š]
    R --> S[æµç¨‹ç»“æŸ]

    style A fill:#4CAF50,stroke:#388E3C,stroke-width:2px,color:white
    style B fill:#2196F3
    style C,D,E fill:#FFC107
    style F,G,H,I,J,K fill:#FFC107
    style L,M,N,O,P fill:#FFC107
    style Q,R fill:#9E9E9E
    style S fill:#4CAF50
```

**æµç¨‹ç‰¹ç‚¹**ï¼š
- **ä¸²è¡Œä¾èµ–**ï¼šæ¯ä¸ªé˜¶æ®µå¿…é¡»å®Œæˆæ‰èƒ½è¿›å…¥ä¸‹ä¸€é˜¶æ®µ
- **å¹¶è¡Œæ‰§è¡Œ**ï¼šç ”ç©¶åŸŸçš„ 6 ä¸ªæ™ºèƒ½ä½“å¯å¹¶è¡Œè°ƒç”¨ LLMï¼ˆå—å¹¶å‘æ§åˆ¶å™¨é™åˆ¶ï¼‰
- **åŸå­æ€§**ï¼šä»»ä¸€ç¯èŠ‚å¤±è´¥ï¼Œç³»ç»Ÿç»ˆæ­¢å¹¶è¾“å‡ºé”™è¯¯æ—¥å¿—ï¼Œä¸ç”Ÿæˆéƒ¨åˆ†æ–‡æ¡£
- **å¹‚ç­‰æ€§**ï¼šç›¸åŒè¾“å…¥ + ç›¸åŒç¼“å­˜ â†’ ç›¸åŒè¾“å‡º

### æŠ€æœ¯å¤„ç†æµç¨‹ï¼šLLMæ¨ç†ä¸ç¼“å­˜ä¼˜åŒ–

```mermaid
graph TD
    A[æ™ºèƒ½ä½“å‘èµ·LLMè°ƒç”¨] --> B[LLMå®¢æˆ·ç«¯åŸŸï¼šé€‰æ‹©æä¾›å•†]
    B --> C[ç¼“å­˜åŸŸï¼šåŸºäºPromptå“ˆå¸ŒæŸ¥è¯¢ç¼“å­˜]
    C -- å‘½ä¸­ --> D[ç›´æ¥è¿”å›ç¼“å­˜ç»“æœ]
    C -- æœªå‘½ä¸­ --> E[LLMå®¢æˆ·ç«¯åŸŸï¼šæ‰§è¡ŒReActå¤šè½®æ¨ç†]
    E --> F[ç¼“å­˜åŸŸï¼šåºåˆ—åŒ–ç»“æœå¹¶å†™å…¥ç¼“å­˜æ–‡ä»¶]
    F --> G[ç¼“å­˜åŸŸï¼šè®°å½•å‘½ä¸­ç‡ã€èŠ‚çœTokenä¸ä¼°ç®—æˆæœ¬]
    G --> H[è¿”å›æ¨ç†ç»“æœç»™è°ƒç”¨æ–¹]

    style A fill:#FFC107
    style B,E fill:#E91E63
    style C,F,G fill:#673AB7
    style D,H fill:#FFC107

    classDef llm fill:#E91E63,stroke:#C2185B,stroke-width:2px,color:white;
    classDef cache fill:#673AB7,stroke:#5E35B1,stroke-width:2px,color:white;
    classDef agent fill:#FFC107,stroke:#FFA000,stroke-width:2px;
    class A,B,E,G,H agent
    class C,F cache
```

**å…³é”®å®ç°ç»†èŠ‚**ï¼š
- **å“ˆå¸Œé”®ç”Ÿæˆ**ï¼š`MD5(prompt + model + temperature + system_prompt)`ï¼Œç¡®ä¿è¯­ä¹‰ç›¸åŒåˆ™é”®ç›¸åŒ
- **ç¼“å­˜è¿‡æœŸ**ï¼šé»˜è®¤ 7 å¤©ï¼Œæ”¯æŒ `--cache-ttl 1d` é…ç½®
- **ç¼“å­˜æ¸…ç†**ï¼š`deepwiki-rs clean` å‘½ä»¤å¯æ‰‹åŠ¨åˆ é™¤ç¼“å­˜
- **æ€§èƒ½ç›‘æ§**ï¼šæ¯æ¬¡è°ƒç”¨è®°å½•ï¼š
  ```json
  {
    "prompt_hash": "a1b2c3...",
    "hit": true,
    "saved_tokens": 1240,
    "saved_cost_usd": 0.008,
    "timestamp": "2025-04-05T10:30:00Z"
  }
  ```

### æ•°æ®æµè½¬è·¯å¾„

```mermaid
graph LR
    A[æºç æ–‡ä»¶] -->|è¢«æ‰«æ| B[ç»“æ„æ‰«æå™¨]
    B --> C[è¯­è¨€å¤„ç†å™¨]
    C --> D[CodeInsight]
    D --> E[å†…å­˜å­˜å‚¨åŸŸ]
    E --> F[ç ”ç©¶æ™ºèƒ½ä½“]
    F --> G[LLMå®¢æˆ·ç«¯]
    G --> H[ç¼“å­˜]
    H --> I[LLMæœåŠ¡]
    I --> G
    G --> E
    E --> J[æ–‡æ¡£ç¼–è¾‘å™¨]
    J --> K[DocTree]
    K --> L[è¾“å‡ºå™¨]
    L --> M[./docs/]

    style A fill:#FF9800
    style B,C,D fill:#FFC107
    style E fill:#2196F3
    style F,G,J fill:#FFC107
    style H fill:#673AB7
    style I fill:#FF9800
    style K fill:#FFC107
    style L fill:#9E9E9E
    style M fill:#FF9800
```

> âœ… **æ•°æ®æµå”¯ä¸€æ€§**ï¼šæ‰€æœ‰æ•°æ®ä»â€œæ–‡ä»¶â€è¿›å…¥â€œå†…å­˜â€ï¼Œæœ€ç»ˆä»â€œå†…å­˜â€å†™å‡ºâ€œæ–‡ä»¶â€ï¼Œä¸­é—´æ— æ•°æ®åº“ã€æ— é˜Ÿåˆ—ã€æ— å¤–éƒ¨çŠ¶æ€ã€‚

### å¼‚å¸¸å¤„ç†æœºåˆ¶

| å¼‚å¸¸ç±»å‹ | å¤„ç†ç­–ç•¥ | ç”¨æˆ·åé¦ˆ |
|----------|----------|----------|
| **LLMæœåŠ¡è¶…æ—¶/å¤±è´¥** | é‡è¯• 3 æ¬¡ï¼Œå¤±è´¥åé™çº§ä¸ºâ€œç”Ÿæˆå ä½æ–‡æ¡£â€ + è®°å½•è­¦å‘Š | `âš ï¸ LLMè°ƒç”¨å¤±è´¥ï¼šMoonshot 503ï¼Œå·²é™çº§ä¸ºç¼“å­˜æ¨¡å¼` |
| **æ–‡ä»¶è¯»å–æƒé™ä¸è¶³** | è·³è¿‡æ–‡ä»¶ï¼Œè®°å½•æ—¥å¿—ï¼Œç»§ç»­æ‰§è¡Œ | `âŒ æ— æ³•è¯»å– ./secret/config.tomlï¼šæƒé™è¢«æ‹’ç»` |
| **è¯­è¨€å¤„ç†å™¨ä¸æ”¯æŒ** | è·³è¿‡æ–‡ä»¶ï¼Œè®°å½•æ‰©å±•å | `â„¹ï¸ è·³è¿‡ .proto æ–‡ä»¶ï¼šæš‚ä¸æ”¯æŒ Protocol Buffers` |
| **å†…å­˜æº¢å‡º** | é™åˆ¶æœ€å¤§æ–‡ä»¶å¤§å°ï¼ˆ10MBï¼‰ï¼Œè§¦å‘ GC | `âš ï¸ æ–‡ä»¶è¿‡å¤§ï¼ˆ12MBï¼‰ï¼Œå·²æˆªæ–­ä¸ºå‰ 10MB` |
| **ç¼“å­˜æ–‡ä»¶æŸå** | åˆ é™¤æŸåæ–‡ä»¶ï¼Œé‡æ–°ç”Ÿæˆ | `ğŸ—‘ï¸ ç¼“å­˜æ–‡ä»¶ a1b2c3.json æŸåï¼Œå·²åˆ é™¤å¹¶é‡è¯•` |
| **é…ç½®é”™è¯¯** | ä¼˜é›…é™çº§ï¼šä½¿ç”¨é»˜è®¤å€¼ï¼Œæç¤ºç”¨æˆ·ä¿®æ­£ | `â— é…ç½®ä¸­ LLM_API_KEY ä¸ºç©ºï¼Œå·²ä½¿ç”¨é»˜è®¤æ¨¡å‹ï¼ˆMistralï¼‰` |

> âœ… **å®¹é”™å“²å­¦**ï¼š**ä¸å› å•ç‚¹å¤±è´¥ä¸­æ–­æ•´ä½“æµç¨‹**ï¼Œä¼˜å…ˆä¿è¯æ–‡æ¡£å®Œæ•´æ€§ï¼Œå…¶æ¬¡ä¿è¯å‡†ç¡®æ€§ã€‚

---

## 6. æŠ€æœ¯å®ç° (Technical Implementation)

### æ ¸å¿ƒæ¨¡å—å®ç°

#### 1. å†…å­˜å­˜å‚¨åŸŸï¼ˆMemoryï¼‰

```rust
// src/memory/mod.rs
pub struct Memory {
    data: Arc<RwLock<HashMap<String, serde_json::Value>>>,
    scopes: Arc<RwLock<HashMap<String, Vec<String>>>>, // scope -> key list
}

impl Memory {
    pub fn store(&self, scope: &str, key: &str, value: impl Serialize) -> Result<()> {
        let json = serde_json::to_value(value)?;
        let mut data = self.data.write().unwrap();
        data.insert(format!("{}.{}", scope, key), json);
        let mut scopes = self.scopes.write().unwrap();
        scopes.entry(scope.to_string()).or_default().push(key.to_string());
        Ok(())
    }

    pub fn get<T: DeserializeOwned>(&self, scope: &str, key: &str) -> Result<Option<T>> {
        let data = self.data.read().unwrap();
        let full_key = format!("{}.{}", scope, key);
        match data.get(&full_key) {
            Some(val) => Ok(Some(serde_json::from_value::<T>(val.clone())?)),
            None => Ok(None),
        }
    }
}
```

- **çº¿ç¨‹å®‰å…¨**ï¼š`Arc<RwLock<T>>` å®ç°è¯»å†™åˆ†ç¦»ï¼Œæ”¯æŒé«˜å¹¶å‘è¯»å–
- **ä½œç”¨åŸŸéš”ç¦»**ï¼š`scope.key` å‘½åç©ºé—´é¿å…å†²çªï¼ˆå¦‚ `research.system_context` vs `doc.overview`ï¼‰
- **åºåˆ—åŒ–å…¼å®¹**ï¼šæ‰€æœ‰æ•°æ®ç»Ÿä¸€ä¸º `serde_json::Value`ï¼Œæ”¯æŒä»»æ„ç»“æ„ä½“

#### 2. LLMå®¢æˆ·ç«¯ä¸ReActæ‰§è¡Œå™¨

```rust
// src/llm/client/react_executor.rs
pub struct ReActExecutor {
    provider: Box<dyn LlmProvider>,
    max_turns: usize,
}

impl ReActExecutor {
    pub async fn execute_multi_turn(&self, prompt: &str, tools: &[Tool]) -> Result<String> {
        let mut thoughts = Vec::new();
        let mut actions = Vec::new();
        let mut observations = Vec::new();

        for _ in 0..self.max_turns {
            let response = self.provider.call(prompt).await?;
            let thought = extract_thought(&response);
            let action = extract_action(&response);
            let observation = execute_tool(action, tools).await?;

            thoughts.push(thought);
            actions.push(action);
            observations.push(observation);

            if is_final_answer(&response) {
                return Ok(extract_final_answer(&response));
            }

            prompt = format!("{}\nThought: {}\nAction: {}\nObservation: {}", 
                prompt, thought, action, observation);
        }

        Err("Max turns reached without final answer".into())
    }
}
```

- **ReAct æ¨¡å¼**ï¼šæ€è€ƒ â†’ åŠ¨ä½œ â†’ è§‚å¯Ÿ â†’ é‡å¤ï¼Œæ”¯æŒå·¥å…·è°ƒç”¨ï¼ˆå¦‚â€œè¯»å–æ–‡ä»¶â€ï¼‰
- **å·¥å…·è°ƒç”¨**ï¼šå¯è°ƒç”¨æœ¬åœ°å·¥å…·ï¼ˆå¦‚ `read_file`ï¼‰è·å–ä¸Šä¸‹æ–‡ï¼Œå‡å°‘ Prompt é•¿åº¦
- **Fallback æœºåˆ¶**ï¼šè‹¥ ReAct å¤±è´¥ï¼Œè°ƒç”¨ `generate_fallback_summary()` ç”Ÿæˆä¿å®ˆç»“æœ

#### 3. å¤šè¯­è¨€å¤„ç†å™¨æ’ä»¶ç³»ç»Ÿ

```rust
// src/generator/preprocess/extractors/language_processors/mod.rs
pub trait LanguageProcessor {
    fn file_extensions(&self) -> &[&str];
    fn extract_dependencies(&self, content: &str) -> Vec<Dependency>;
    fn extract_interfaces(&self, content: &str) -> Vec<InterfaceInfo>;
    fn classify_component_type(&self, path: &Path) -> ComponentType;
}

pub struct RustProcessor;
impl LanguageProcessor for RustProcessor {
    fn file_extensions(&self) -> &[&str] { &["rs", "mod.rs"] }
    fn extract_dependencies(&self, content: &str) -> Vec<Dependency> {
        let ast = syn::parse_file(content).unwrap();
        ast.items.iter()
            .filter_map(|item| match item {
                syn::Item::Use(use_item) => Some(Dependency { name: use_item.path.to_string() }),
                _ => None,
            })
            .collect()
    }
}
```

- **æ³¨å†Œæœºåˆ¶**ï¼šåœ¨ `LanguageProcessorManager` åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡ `register()` æ³¨å†Œæ‰€æœ‰å¤„ç†å™¨
- **è‡ªåŠ¨å‘ç°**ï¼šæ”¯æŒé€šè¿‡ `#[derive(LanguageProcessor)]` å®è‡ªåŠ¨ç”Ÿæˆæ³¨å†Œä»£ç ï¼ˆæœªæ¥æ‰©å±•ï¼‰

### å…³é”®ç®—æ³•è®¾è®¡

#### 1. æ–‡ä»¶é‡è¦æ€§è¯„åˆ†ç®—æ³•

```rust
fn calculate_importance_score(file: &Path) -> f64 {
    let mut score = 0.0;

    // åŸºç¡€æƒé‡
    score += file.metadata().map(|m| m.len() as f64 / 1000.0).unwrap_or(0.0); // æ–‡ä»¶å¤§å°
    score += if file.file_name().unwrap() == "README.md" { 5.0 } else { 0.0 };
    score += if file.extension() == Some("rs") { 3.0 } else { 0.0 };
    score += if file.parent().map(|p| p.ends_with("src")) == Some(true) { 2.0 } else { 0.0 };

    // å¼•ç”¨æƒé‡ï¼ˆé€šè¿‡ä¾èµ–å›¾è°±ï¼‰
    if let Some(ref_count) = dependency_graph.get_ref_count(file) {
        score += ref_count as f64 * 0.5;
    }

    // æ’é™¤æƒé‡
    if is_ignored(file) { return 0.0; }

    score
}
```

> âœ… è¯¥ç®—æ³•ä½¿ç³»ç»Ÿèƒ½**è‡ªåŠ¨èšç„¦æ ¸å¿ƒæ–‡ä»¶**ï¼Œé¿å…è¢«æµ‹è¯•æ–‡ä»¶ã€é…ç½®æ–‡ä»¶å¹²æ‰°åˆ†æã€‚

#### 2. ç¼“å­˜å“ˆå¸Œé”®ç”Ÿæˆç®—æ³•

```rust
fn generate_cache_key(prompt: &str, model: &str, temperature: f32) -> String {
    let combined = format!("{}|{}|{}", prompt, model, temperature);
    md5::compute(combined.as_bytes()).to_string()
}
```

- **å»é‡èƒ½åŠ›**ï¼šç›¸åŒè¯­ä¹‰çš„ Promptï¼ˆå³ä½¿æ¢è¡Œã€æ³¨é‡Šä¸åŒï¼‰ç”Ÿæˆç›¸åŒå“ˆå¸Œ
- **å¯è¿½æº¯**ï¼šç¼“å­˜æ–‡ä»¶åå³ä¸ºå“ˆå¸Œï¼Œä¾¿äºè°ƒè¯•

### æ•°æ®ç»“æ„è®¾è®¡

| æ•°æ®ç»“æ„ | ç”¨é€” | å­—æ®µç¤ºä¾‹ |
|----------|------|----------|
| `CodeInsight` | ä»£ç è¯­ä¹‰æ¨¡å‹ | `path: String`, `dependencies: Vec<Dependency>`, `interfaces: Vec<Interface>`, `important_lines: Vec<usize>`, `purpose: CodePurpose` |
| `Dependency` | ä¾èµ–å…³ç³» | `from: String`, `to: String`, `type: DependencyType`ï¼ˆuse, call, importï¼‰ |
| `DomainModuleReport` | é¢†åŸŸæ¨¡å— | `name: String`, `components: Vec<Component>`, `external_deps: Vec<String>`, `business_goal: String` |
| `WorkflowReport` | å·¥ä½œæµç¨‹ | `name: String`, `steps: Vec<Step>`, `actors: Vec<String>`, `diagram: String` |
| `DocTree` | æ–‡æ¡£æ ‘ | `path: PathBuf`, `content: String`, `format: Format::Markdown` |

> âœ… æ‰€æœ‰ç»“æ„ä½“å‡å®ç° `Serialize + Deserialize`ï¼Œæ”¯æŒå†…å­˜å­˜å‚¨ä¸ç¼“å­˜æŒä¹…åŒ–ã€‚

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

| ç­–ç•¥ | å®ç°æ–¹å¼ | æ•ˆæœ |
|------|----------|------|
| **LLMç¼“å­˜** | Prompt å“ˆå¸Œ + æ–‡ä»¶ç¼“å­˜ | ç¼“å­˜å‘½ä¸­ç‡ > 75%ï¼Œå¹³å‡èŠ‚çœ 82% Token |
| **å¹¶å‘æ§åˆ¶** | Semaphore é™åˆ¶ LLM å¹¶å‘æ•°ï¼ˆé»˜è®¤ 5ï¼‰ | é¿å… API é™æµï¼Œæå‡ç¨³å®šæ€§ |
| **æ–‡ä»¶é¢„è¯»** | å¼‚æ­¥è¯»å– READMEã€Cargo.toml | å‡å°‘é˜»å¡ç­‰å¾… |
| **æºç æˆªæ–­** | ä»…æå– `important_lines` å‘¨å›´ 10 è¡Œ | Prompt é•¿åº¦å‡å°‘ 60%ï¼Œæ¨ç†é€Ÿåº¦æå‡ 40% |
| **å†…å­˜å¤ç”¨** | `CodeInsight` åœ¨ç ”ç©¶åŸŸä¸­å¤ç”¨ï¼Œä¸é‡å¤è§£æ | é¿å…é‡å¤ AST è§£æï¼ŒèŠ‚çœ CPU |
| **å¼‚æ­¥ I/O** | ä½¿ç”¨ `tokio::fs` æ›¿ä»£ `std::fs` | æ–‡ä»¶æ‰«æé€Ÿåº¦æå‡ 3xï¼ˆ1000 æ–‡ä»¶ â†’ 1.2sï¼‰ |
| **æ— é”ç›‘æ§** | `PerformanceMonitor` ä½¿ç”¨ `AtomicUsize` | æ— é”è®°å½•å‘½ä¸­/æœªå‘½ä¸­ï¼Œæ€§èƒ½æŸè€— < 0.1% |

> ğŸ“Š **å®æµ‹æ€§èƒ½**ï¼ˆ100KB Rust é¡¹ç›®ï¼‰ï¼š
> - é¦–æ¬¡è¿è¡Œï¼š8.2sï¼ˆå« LLM è°ƒç”¨ï¼‰
> - äºŒæ¬¡è¿è¡Œï¼ˆç¼“å­˜å‘½ä¸­ï¼‰ï¼š1.4s
> - ç¼“å­˜å‘½ä¸­ç‡ï¼š83%
> - èŠ‚çœ Tokenï¼š12,400 / æ¬¡
> - èŠ‚çœæˆæœ¬ï¼š$0.08 / æ¬¡

---

## 7. éƒ¨ç½²æ¶æ„ (Deployment Architecture)

### è¿è¡Œç¯å¢ƒè¦æ±‚

| é¡¹ç›® | è¦æ±‚ |
|------|------|
| **æ“ä½œç³»ç»Ÿ** | Linuxã€macOSã€Windows 10+ï¼ˆx86_64ï¼‰ |
| **Rust ç¯å¢ƒ** | Rust 1.75+ï¼ˆé€šè¿‡ `rustup` å®‰è£…ï¼‰ |
| **å†…å­˜** | â‰¥ 4GBï¼ˆæ¨è 8GBï¼Œå¤„ç†å¤§å‹é¡¹ç›®ï¼‰ |
| **ç£ç›˜** | â‰¥ 100MB å¯ç”¨ç©ºé—´ï¼ˆç¼“å­˜ä¸è¾“å‡ºï¼‰ |
| **ç½‘ç»œ** | éœ€è®¿é—® LLM æœåŠ¡ï¼ˆå¦‚ Moonshot APIï¼‰ |
| **æƒé™** | è¯»å–æºç ç›®å½•ã€å†™å…¥è¾“å‡ºç›®å½•æƒé™ |

> âœ… **æ— éœ€ Dockerã€K8sã€æ•°æ®åº“**ï¼Œå•äºŒè¿›åˆ¶éƒ¨ç½²ï¼Œç¬¦åˆâ€œå¼€å‘è€…å·¥å…·â€å®šä½ã€‚

### éƒ¨ç½²æ‹“æ‰‘ç»“æ„

```mermaid
graph LR
    A[å¼€å‘è€…æœºå™¨] --> B[deepwiki-rs äºŒè¿›åˆ¶]
    B --> C[æœ¬åœ°æºç ç›®å½•<br>./my-project]
    B --> D[ç¼“å­˜ç›®å½•<br>.deepwiki/cache/]
    B --> E[è¾“å‡ºç›®å½•<br>./docs/]
    B --> F[LLMæœåŠ¡<br>Moonshot API]
    B --> G[é…ç½®æ–‡ä»¶<br>.deepwiki.toml]

    style A fill:#FFF3CD
    style B fill:#4CAF50
    style C fill:#FF9800
    style D fill:#673AB7
    style E fill:#FF9800
    style F fill:#FF9800
    style G fill:#2196F3
```

> âœ… **éƒ¨ç½²æ–¹å¼**ï¼š
> ```bash
> cargo install --git https://github.com/deepwiki/deepwiki-rs
> deepwiki-rs --p ./my-app -o ./docs
> ```

### æ‰©å±•æ€§è®¾è®¡

| æ‰©å±•ç»´åº¦ | æ‰©å±•ç‚¹ | å®ç°æ–¹å¼ |
|----------|--------|----------|
| **æ–°å¢è¯­è¨€** | è¯­è¨€å¤„ç†å™¨ | å®ç° `LanguageProcessor` traitï¼Œæ³¨å†Œåˆ°ç®¡ç†å™¨ |
| **æ–°å¢LLMæä¾›å•†** | æä¾›å•†é€‚é…å™¨ | å®ç° `LlmProvider` traitï¼Œæ³¨å†Œåˆ° `ProviderRegistry` |
| **æ–°å¢è¾“å‡ºæ ¼å¼** | è¾“å‡ºå™¨ | å®ç° `OutputAdapter` traitï¼Œæ”¯æŒ PDFã€HTMLã€JSON |
| **æ–°å¢æ™ºèƒ½ä½“** | ç ”ç©¶/ç¼–æ’æ™ºèƒ½ä½“ | å®ç° `Agent` traitï¼Œæ³¨å†Œåˆ°ç¼–æ’å™¨ |
| **æ–°å¢é…ç½®é¡¹** | é…ç½®æ¨¡å‹ | åœ¨ `Config` ç»“æ„ä½“ä¸­æ·»åŠ å­—æ®µï¼Œæ”¯æŒ TOML ä¸ ENV |
| **æ–°å¢ç›‘æ§æŒ‡æ ‡** | æ€§èƒ½ç›‘æ§ | åœ¨ `PerformanceMonitor` ä¸­æ·»åŠ æ–°æŒ‡æ ‡ï¼Œæš´éœ² Prometheus endpoint |

> âœ… **æ‰©å±•ç¤ºä¾‹**ï¼š  
> æƒ³æ”¯æŒ Go è¯­è¨€ï¼Ÿåªéœ€ï¼š
> 1. åˆ›å»º `src/generator/preprocess/extractors/language_processors/go.rs`
> 2. å®ç° `LanguageProcessor`ï¼Œè§£æ `import` å’Œ `package`
> 3. åœ¨ `mod.rs` ä¸­ `register(GoProcessor {})`
> 4. æ— éœ€ä¿®æ”¹ä»»ä½•å…¶ä»–ä»£ç ï¼

### ç›‘æ§ä¸è¿ç»´

| ç›‘æ§ç»´åº¦ | å®ç°æ–¹å¼ | è¿ç»´å»ºè®® |
|----------|----------|----------|
| **ç¼“å­˜å‘½ä¸­ç‡** | `PerformanceMonitor::generate_report()` è¾“å‡º JSON | æ¯å‘¨æ£€æŸ¥ï¼Œè‹¥ < 60%ï¼Œéœ€ä¼˜åŒ– Prompt æ¨¡æ¿ |
| **Tokenæ¶ˆè€—** | æ¯æ¬¡è°ƒç”¨è®°å½• `saved_tokens` | è®¾ç½®é¢„ç®—å‘Šè­¦ï¼ˆå¦‚æ¯æœˆ > $5ï¼‰ |
| **æ‰§è¡Œè€—æ—¶** | `tracing::info!` è®°å½• `analyze` æ€»è€—æ—¶ | ä¼˜åŒ–å»ºè®®ï¼šè‹¥ > 10sï¼Œæ£€æŸ¥æ˜¯å¦æ‰«æäº† `node_modules` |
| **é”™è¯¯æ—¥å¿—** | `tracing::error!` è¾“å‡ºåˆ° `stderr` | é›†æˆåˆ° CI/CDï¼Œå¤±è´¥æ—¶é˜»æ–­æµç¨‹ |
| **ç¼“å­˜æ¸…ç†** | `deepwiki-rs clean` å‘½ä»¤ | å»ºè®®æ¯å‘¨æ‰§è¡Œä¸€æ¬¡ï¼Œé‡Šæ”¾ç£ç›˜ç©ºé—´ |
| **ç‰ˆæœ¬å…¼å®¹** | äºŒè¿›åˆ¶ç‰ˆæœ¬å·ä¸ç¼“å­˜æ ¼å¼ç»‘å®š | å‡çº§æ—¶è‡ªåŠ¨æ¸…ç†ä¸å…¼å®¹ç¼“å­˜ |

> âœ… **è¿ç»´æœ€ä½³å®è·µ**ï¼š
> - å°† `./docs/` æäº¤è‡³ Gitï¼Œä½œä¸ºé¡¹ç›®æ–‡æ¡£æº
> - å°† `.deepwiki/cache/` åŠ å…¥ `.gitignore`
> - åœ¨ CI ä¸­åŠ å…¥ `deepwiki-rs analyze --check`ï¼Œç¡®ä¿æ–‡æ¡£ä¸ä»£ç åŒæ­¥

---

## æ¶æ„æ´å¯Ÿæ€»ç»“

### âœ… æ‰©å±•æ€§è®¾è®¡äº®ç‚¹
- **æ’ä»¶åŒ–æ¶æ„**ï¼šæ‰€æœ‰æ‰©å±•ç‚¹å‡é€šè¿‡ trait å®šä¹‰ï¼Œå®ç°â€œå¼€é—­åŸåˆ™â€
- **æ— ä¾µå…¥æ‰©å±•**ï¼šæ–°å¢åŠŸèƒ½æ— éœ€ä¿®æ”¹æ ¸å¿ƒé€»è¾‘
- **é…ç½®é©±åŠ¨**ï¼šæ‰€æœ‰è¡Œä¸ºå¯é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶ï¼Œæ— éœ€ä»£ç å˜æ›´

### âœ… æ€§èƒ½ä¼˜åŒ–äº®ç‚¹
- **ç¼“å­˜é©±åŠ¨æˆæœ¬æ§åˆ¶**ï¼šå°† LLM æˆæœ¬ä»â€œä¸å¯æ§â€å˜ä¸ºâ€œå¯é¢„æµ‹â€
- **å†…å­˜æ€»çº¿å‡å°‘åºåˆ—åŒ–å¼€é”€**ï¼šé¿å…è·¨è¿›ç¨‹é€šä¿¡ï¼Œæå‡åå
- **å¼‚æ­¥å¹¶å‘æœ€å¤§åŒ–**ï¼šå……åˆ†åˆ©ç”¨å¤šæ ¸ CPU ä¸ç½‘ç»œ I/O

### âœ… å®‰å…¨æ€§è®¾è®¡äº®ç‚¹
- **æœ¬åœ°å¤„ç†**ï¼šä»£ç ä¸ä¸Šä¼ äº‘ç«¯
- **æ•æ„Ÿä¿¡æ¯è¿‡æ»¤**ï¼šè‡ªåŠ¨å±è”½å¯†é’¥ã€å¯†ç 
- **æœ€å°æƒé™**ï¼šä»…éœ€è¯»å–æºç ã€å†™å…¥è¾“å‡ºç›®å½•

### âœ… å¼€å‘æŒ‡å¯¼
- **æ–°äººä¸Šæ‰‹**ï¼šä» `main.rs` â†’ `cli.rs` â†’ `config.rs` â†’ `preprocess/` é€æ­¥é˜…è¯»
- **è´¡çŒ®æµç¨‹**ï¼šæ–°å¢è¯­è¨€ â†’ å®ç° `LanguageProcessor` â†’ æäº¤ PR
- **è°ƒè¯•æŠ€å·§**ï¼š`RUST_LOG=debug deepwiki-rs analyze` æŸ¥çœ‹å†…å­˜ä¸Šä¸‹æ–‡

### âœ… çŸ¥è¯†ä¼ æ‰¿ä»·å€¼
deepwiki-rs ä¸ä»…æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œæ›´æ˜¯ä¸€ç§**æ¶æ„çŸ¥è¯†å·¥ç¨‹æ–¹æ³•è®º**çš„å®ç°ï¼š
> **â€œè®©ä»£ç è‡ªå·±è¯´è¯ï¼Œè®©æ–‡æ¡£æˆä¸ºä»£ç çš„é•œåƒã€‚â€**

å®ƒå°†â€œæ¶æ„æ–‡æ¡£â€ä»â€œäººå·¥æ’°å†™â€çš„è´Ÿæ‹…ï¼Œè½¬å˜ä¸ºâ€œè‡ªåŠ¨åŒ–æ²‰æ·€â€çš„èµ„äº§ï¼Œæ˜¯ç°ä»£è½¯ä»¶å·¥ç¨‹è¿ˆå‘**è‡ªæè¿°ç³»ç»Ÿ**çš„å…³é”®ä¸€æ­¥ã€‚

--- 

> ğŸ“Œ **é™„å½•ï¼šæ¨èä½¿ç”¨å§¿åŠ¿**  
> å°† `deepwiki-rs analyze` åµŒå…¥ CI/CD æµç¨‹ï¼Œæ¯æ¬¡ `git push` è‡ªåŠ¨æ›´æ–° `./docs/`ï¼Œå¹¶ç”Ÿæˆ PR è¯„è®ºï¼š  
> `âœ… æ¶æ„æ–‡æ¡£å·²æ›´æ–°ï¼šç³»ç»Ÿä¸Šä¸‹æ–‡å›¾ã€é¢†åŸŸæ¨¡å—å›¾ã€æ ¸å¿ƒæµç¨‹å›¾å‡å·²åŒæ­¥ã€‚`  
> è®©æ¶æ„æ–‡æ¡£ï¼Œæˆä¸ºä»£ç å®¡æŸ¥çš„ä¸€éƒ¨åˆ†ã€‚

---  
**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.2  
**æœ€åæ›´æ–°**ï¼š2025å¹´4æœˆ  
**ä½œè€…**ï¼šdeepwiki-rs æ¶æ„å›¢é˜Ÿ