# é…ç½®ç®¡ç†åŸŸæŠ€æœ¯æ–‡æ¡£

---

## **1. æ¦‚è¿°**

**é…ç½®ç®¡ç†åŸŸ**æ˜¯ `deepwiki-rs` ç³»ç»Ÿçš„**å”¯ä¸€å¯åŠ¨å…¥å£ä¸å…¨å±€é…ç½®ä¸­æ¢**ï¼Œè´Ÿè´£ç³»ç»Ÿæ‰€æœ‰è¿è¡Œæ—¶å‚æ•°çš„åŠ è½½ã€è§£æã€åˆå¹¶ä¸æ ‡å‡†åŒ–ã€‚ä½œä¸ºåŸºç¡€è®¾æ–½åŸŸçš„æ ¸å¿ƒç»„ä»¶ï¼Œå®ƒä¸ºæ•´ä¸ªç³»ç»Ÿæä¾›**ç»Ÿä¸€ã€å¯è¿½æº¯ã€å¯é™çº§**çš„é…ç½®æ¨¡å‹ï¼Œæ˜¯å®ç°â€œ**é›¶é…ç½®å¯è¿è¡Œ**â€ä¸â€œ**å¤šç¯å¢ƒè‡ªé€‚åº”**â€æ¶æ„ç›®æ ‡çš„åŸºçŸ³ã€‚

è¯¥æ¨¡å—ä¸åŒ…å«ä»»ä½•ä¸šåŠ¡é€»è¾‘ï¼Œä½†å´æ˜¯æ‰€æœ‰åç»­æ¨¡å—ï¼ˆLLMå®¢æˆ·ç«¯ã€é¢„å¤„ç†ã€ç¼“å­˜ã€è¾“å‡ºç­‰ï¼‰ä¾èµ–çš„**é…ç½®å¥‘çº¦**ã€‚å…¶è®¾è®¡éµå¾ªâ€œ**é…ç½®å³ä»£ç ã€ä¼˜å…ˆçº§æ˜ç¡®ã€æ‰©å±•æ€§ä¼˜å…ˆ**â€åŸåˆ™ï¼Œé€šè¿‡ç»“æ„åŒ–æ•°æ®æ¨¡å‹ä¸å£°æ˜å¼é…ç½®æœºåˆ¶ï¼Œå®ç°ä»ç”¨æˆ·è¾“å…¥åˆ°ç³»ç»Ÿè¡Œä¸ºçš„ç²¾å‡†æ˜ å°„ã€‚

> âœ… **æ ¸å¿ƒä»·å€¼**ï¼š  
> - ä½œä¸ºç³»ç»Ÿå¯åŠ¨çš„**å”¯ä¸€å…¥å£ç‚¹**ï¼Œç¡®ä¿åˆå§‹åŒ–è¡Œä¸ºä¸€è‡´  
> - æ”¯æŒ**å››å±‚é…ç½®ä¼˜å…ˆçº§**ï¼ˆCLI > é…ç½®æ–‡ä»¶ > ç¯å¢ƒå˜é‡ > é»˜è®¤å€¼ï¼‰ï¼Œå®ç°çµæ´»éƒ¨ç½²  
> - è‡ªåŠ¨æ¨æ–­é¡¹ç›®åç§°ï¼Œé™ä½ç”¨æˆ·é…ç½®è´Ÿæ‹…  
> - æ‰€æœ‰é…ç½®é¡¹åºåˆ—åŒ–ä¸ºæ ‡å‡†ç»“æ„ä½“ï¼Œå®ç°è·¨åŸŸå…±äº«ä¸ç±»å‹å®‰å…¨  

---

## **2. æ¶æ„è®¾è®¡**

### **2.1 æ¨¡å—å®šä½ä¸å±‚çº§å…³ç³»**

```mermaid
graph LR
    A[ç”¨æˆ·å±‚] --> B[é…ç½®ç®¡ç†åŸŸ]
    B --> C[åŸºç¡€è®¾æ–½åŸŸ]
    B --> D[LLMå®¢æˆ·ç«¯åŸŸ]
    B --> E[ç¼“å­˜åŸŸ]
    B --> F[é¢„å¤„ç†åŸŸ]
    B --> G[å†…å­˜å­˜å‚¨åŸŸ]
    
    style B fill:#2196F3,stroke:#1976D2,stroke-width:2px,color:white
    style C fill:#2196F3,stroke:#1976D2,stroke-width:1px,color:white
    style D fill:#E91E63,stroke:#C2185B,stroke-width:1px,color:white
    style E fill:#673AB7,stroke:#5E35B1,stroke-width:1px,color:white
    style F fill:#FFC107,stroke:#FFA000,stroke-width:1px
```

- **è¾“å…¥æº**ï¼šç¯å¢ƒå˜é‡ã€TOMLé…ç½®æ–‡ä»¶ã€CLIå‘½ä»¤è¡Œå‚æ•°
- **è¾“å‡ºç‰©**ï¼šæ ‡å‡†åŒ–çš„ `Config` å®ä¾‹ï¼Œä¾›å…¨ç³»ç»Ÿæ¶ˆè´¹
- **ä¾èµ–å…³ç³»**ï¼š
  - **è¢«ä¾èµ–**ï¼šLLMå®¢æˆ·ç«¯ã€ç¼“å­˜åŸŸã€é¢„å¤„ç†åŸŸã€è¾“å‡ºåŸŸå‡ä¾èµ–å…¶æä¾›çš„é…ç½®é¡¹
  - **æ— ä¾èµ–**ï¼šè‡ªèº«ä¸ä¾èµ–ä»»ä½•å…¶ä»–ä¸šåŠ¡æ¨¡å—ï¼Œå®Œå…¨è‡ªåŒ…å«ï¼Œç¬¦åˆâ€œå¯åŠ¨å‰ç½®â€åŸåˆ™

### **2.2 æ ¸å¿ƒè®¾è®¡åŸåˆ™**

| åŸåˆ™ | è¯´æ˜ | å®ç°æ–¹å¼ |
|------|------|----------|
| **å•ä¸€èŒè´£** | ä»…è´Ÿè´£é…ç½®åŠ è½½ä¸åˆå¹¶ï¼Œä¸å‚ä¸ä¸šåŠ¡é€»è¾‘ | æ— ä¸šåŠ¡æ–¹æ³•ï¼Œä»…æä¾› `Config` ç»“æ„ä½“ä¸ `from_file()`ã€`to_config()` ç­‰çº¯æ•°æ®è½¬æ¢å‡½æ•° |
| **ä¼˜å…ˆçº§æ˜ç¡®** | é…ç½®è¦†ç›–é¡ºåºä¸¥æ ¼å®šä¹‰ | CLI > é…ç½®æ–‡ä»¶ > ç¯å¢ƒå˜é‡ > é»˜è®¤å€¼ï¼Œé€šè¿‡ `merge()` æ–¹æ³•é€å±‚è¦†ç›– |
| **é™çº§å¯ç”¨** | æ— é…ç½®æ–‡ä»¶æ—¶ä»å¯è¿è¡Œ | å®ç° `Default` traitï¼Œæä¾›å®Œæ•´é»˜è®¤é…ç½® |
| **ç±»å‹å®‰å…¨** | æ‰€æœ‰é…ç½®é¡¹å¼ºç±»å‹åŒ– | ä½¿ç”¨ Rust ç»“æ„ä½“ + Serde ååºåˆ—åŒ–ï¼Œç¼–è¯‘æœŸæ ¡éªŒ |
| **å¯æ‰©å±•æ€§** | æ”¯æŒæ–°å¢é…ç½®é¡¹æ— éœ€é‡æ„ | æ‰€æœ‰ç»“æ„ä½“æ´¾ç”Ÿ `Deserialize`ï¼Œæ–°å¢å­—æ®µè‡ªåŠ¨å…¼å®¹ |
| **å¯è¿½æº¯æ€§** | é…ç½®æ¥æºå¯è¿½è¸ª | æ¯ä¸ªé…ç½®é¡¹è®°å½•å…¶æ¥æºï¼ˆfile/env/cli/defaultï¼‰ |

---

## **3. æ ¸å¿ƒæ•°æ®æ¨¡å‹**

### **3.1 ä¸»é…ç½®ç»“æ„ä½“ï¼š`Config`**

```rust
#[derive(Debug, Clone, Serialize, Deserialize, Default)]
pub struct Config {
    pub project_path: PathBuf,
    pub output_path: PathBuf,
    pub internal_path: PathBuf,
    pub project_name: Option<String>,
    pub llm: LLMConfig,
    pub cache: CacheConfig,
    pub preprocess: PreprocessConfig,
    pub output: OutputConfig,
}
```

> âœ… **è®¾è®¡è¯´æ˜**ï¼š
> - æ‰€æœ‰å­—æ®µå‡ä¸º `Option<T>` æˆ–é»˜è®¤å€¼ï¼Œç¡®ä¿**éƒ¨åˆ†ç¼ºå¤±ä¸æŠ¥é”™**
> - `project_path` é»˜è®¤ä¸ºå½“å‰å·¥ä½œç›®å½•ï¼Œ`output_path` é»˜è®¤ä¸º `./docs`
> - `project_name` ä¸º**å¯æ¨æ–­å­—æ®µ**ï¼Œè‹¥æœªæ˜¾å¼é…ç½®ï¼Œç³»ç»Ÿè‡ªåŠ¨ä»é¡¹ç›®æ ¹ç›®å½•æ¢æµ‹ `Cargo.toml`ã€`package.json` ç­‰æ–‡ä»¶

### **3.2 å­é…ç½®æ¨¡å—**

#### **3.2.1 LLM é…ç½®ï¼š`LLMConfig`**

```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct LLMConfig {
    pub provider: LLMProvider,
    pub api_key: Option<String>,
    pub base_url: Option<String>,
    pub model: Option<String>,
    pub temperature: Option<f64>,
    pub max_tokens: Option<u32>,
    pub timeout_seconds: u64,
}
```

- `provider`ï¼šæšä¸¾ç±»å‹ï¼Œæ”¯æŒ `Moonshot`, `Mistral`, `OpenRouter`, `Gemini`, `Anthropic` ç­‰
- `api_key` / `base_url`ï¼šæ”¯æŒä»ç¯å¢ƒå˜é‡ `LLM_API_KEY`ã€`LLM_BASE_URL` è‡ªåŠ¨æ³¨å…¥
- `timeout_seconds`ï¼šé»˜è®¤ 30sï¼Œé˜²æ­¢ LLM å“åº”è¶…æ—¶é˜»å¡ä¸»çº¿ç¨‹

#### **3.2.2 ç¼“å­˜é…ç½®ï¼š`CacheConfig`**

```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct CacheConfig {
    pub enabled: bool,
    pub cache_dir: PathBuf,
    pub ttl_minutes: u64,
    pub enable_monitoring: bool,
    pub max_cache_size_mb: u64,
}
```

- `enabled`ï¼šé»˜è®¤ `true`ï¼Œå¯é€šè¿‡ `--no-cache` CLI å‚æ•°ç¦ç”¨
- `cache_dir`ï¼šé»˜è®¤ä¸º `./.deepwiki/cache`ï¼Œæ”¯æŒç›¸å¯¹/ç»å¯¹è·¯å¾„
- `ttl_minutes`ï¼šç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œé»˜è®¤ 1440 åˆ†é’Ÿï¼ˆ24å°æ—¶ï¼‰
- `enable_monitoring`ï¼šæ˜¯å¦å¯ç”¨æ€§èƒ½ç›‘æ§å™¨ï¼Œç”¨äºç”Ÿæˆæ€»ç»“æŠ¥å‘Š

#### **3.2.3 é¢„å¤„ç†é…ç½®ï¼š`PreprocessConfig`**

```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct PreprocessConfig {
    pub ignore_patterns: Vec<String>,
    pub max_concurrent_files: usize,
    pub supported_languages: Vec<Language>,
    pub extract_code_lines: bool,
}
```

- `ignore_patterns`ï¼šé»˜è®¤ `[".git/", "target/", "node_modules/", "*.log"]`
- `max_concurrent_files`ï¼šé»˜è®¤ 16ï¼Œå—å·¥å…·æ”¯æ’‘åŸŸçš„å¹¶å‘æ§åˆ¶å™¨çº¦æŸ
- `supported_languages`ï¼šé»˜è®¤æ”¯æŒ `Rust`, `Python`, `JavaScript`, `TypeScript`, `Java`, `Kotlin`, `Vue`, `React`, `Svelte`

#### **3.2.4 è¾“å‡ºé…ç½®ï¼š`OutputConfig`**

```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct OutputConfig {
    pub format: OutputFormat,
    pub include_summary: bool,
    pub compress_output: bool,
}
```

- `format`ï¼šå½“å‰ä»…æ”¯æŒ `Markdown`ï¼Œé¢„ç•™ `PDF`ã€`HTML` æ‰©å±•æ¥å£
- `include_summary`ï¼šæ˜¯å¦ç”Ÿæˆæ€§èƒ½æ€»ç»“æŠ¥å‘Šï¼Œé»˜è®¤ `true`

---

## **4. é…ç½®åŠ è½½ä¸åˆå¹¶æµç¨‹**

### **4.1 é…ç½®ä¼˜å…ˆçº§æ¨¡å‹ï¼ˆå››å±‚è¦†ç›–ï¼‰**

```mermaid
graph LR
    D[é»˜è®¤é…ç½®] --> E[é…ç½®æ–‡ä»¶]
    E --> F[ç¯å¢ƒå˜é‡]
    F --> G[CLIå‚æ•°]
    G --> H[æœ€ç»ˆConfig]
    
    style D fill:#F5F5F5,stroke:#CCCCCC
    style E fill:#E3F2FD,stroke:#2196F3
    style F fill:#E8F5E9,stroke:#4CAF50
    style G fill:#FFF3E0,stroke:#FF9800
    style H fill:#2196F3,stroke:#1976D2,color:white
```

| å±‚çº§ | æ¥æº | è¦†ç›–è§„åˆ™ | ç¤ºä¾‹ |
|------|------|----------|------|
| 1. é»˜è®¤ | `Default::default()` | æœ€ä½ä¼˜å…ˆçº§ï¼Œä»…ä½œå…œåº• | `project_path = "."` |
| 2. é…ç½®æ–‡ä»¶ | `config.toml` | è¦†ç›–é»˜è®¤å€¼ | `project_name = "my-project"` |
| 3. ç¯å¢ƒå˜é‡ | `LLM_API_KEY`, `CACHE_TTL` | è¦†ç›–æ–‡ä»¶ä¸é»˜è®¤å€¼ | `export LLM_PROVIDER=Mistral` |
| 4. CLIå‚æ•° | `--project-name`, `--no-cache` | **æœ€é«˜ä¼˜å…ˆçº§** | `deepwiki --llm-provider Moonshot --no-cache` |

> ğŸ’¡ **å®ç°æœºåˆ¶**ï¼š  
> æ‰€æœ‰é…ç½®é¡¹é€šè¿‡ `merge()` æ–¹æ³•æŒ‰ä¼˜å…ˆçº§é¡ºåºåˆå¹¶ï¼Œé‡‡ç”¨**ä¸å¯å˜æ›´æ–°**ï¼ˆimmutable updateï¼‰ç­–ç•¥ï¼Œé¿å…çŠ¶æ€æ±¡æŸ“ã€‚

### **4.2 åŠ è½½æµç¨‹ï¼ˆåºåˆ—å›¾ï¼‰**

```mermaid
sequenceDiagram
    participant CLI
    participant Config
    participant File

    CLI->>Config: to_config(Args)
    alt é…ç½®æ–‡ä»¶è·¯å¾„å­˜åœ¨ (e.g., --config ./config.toml)
        CLI->>File: è¯»å–æŒ‡å®šè·¯å¾„é…ç½®æ–‡ä»¶
        File-->>Config: è¿”å› TOML å­—ç¬¦ä¸²
        Config->>Config: ä½¿ç”¨ serde::from_str è§£æä¸º Config å®ä¾‹
    else æ— é…ç½®æ–‡ä»¶
        Config->>Config: è°ƒç”¨ Default::default() åˆå§‹åŒ–é»˜è®¤é…ç½®
    end
    Config->>Config: è¦†ç›– project_path, output_path, internal_pathï¼ˆæ¥è‡ª CLIï¼‰
    Config->>Config: è§£æå¹¶è¦†ç›– LLM é…ç½®ï¼ˆæ¥è‡ª CLI æˆ–ç¯å¢ƒå˜é‡ï¼‰
    Config->>Config: è§£æå¹¶è¦†ç›– Cache é…ç½®ï¼ˆå¦‚ no_cache=trueï¼‰
    Config->>Config: è§£æå¹¶è¦†ç›– Preprocess é…ç½®ï¼ˆå¦‚ ignore_patternsï¼‰
    Config->>Config: è‡ªåŠ¨æ¨æ–­ project_nameï¼ˆè°ƒç”¨ infer_project_nameï¼‰
    Config->>CLI: è¿”å›æœ€ç»ˆ Config å®ä¾‹
```

### **4.3 é¡¹ç›®åç§°è‡ªåŠ¨æ¨æ–­æœºåˆ¶**

ä¸ºé™ä½ç”¨æˆ·é…ç½®è´Ÿæ‹…ï¼Œç³»ç»Ÿåœ¨ `infer_project_name()` ä¸­æŒ‰ä¼˜å…ˆçº§æ¢æµ‹ä»¥ä¸‹æ–‡ä»¶ï¼š

| é¡¹ç›®ç±»å‹ | æ¢æµ‹æ–‡ä»¶ | è·å–å­—æ®µ | ç¤ºä¾‹ |
|----------|----------|----------|------|
| Rust | `Cargo.toml` | `package.name` | `[package] name = "my-rust-app"` |
| Node.js | `package.json` | `name` | `{"name": "my-node-app"}` |
| Python | `pyproject.toml` | `project.name` | `[project] name = "my-python-app"` |
| Java | `pom.xml` | `<artifactId>` | `<artifactId>my-java-app</artifactId>` |

> âœ… **å®ç°ç»†èŠ‚**ï¼š
> - ä½¿ç”¨ `std::fs::read_to_string` è¯»å–æ–‡ä»¶
> - ä½¿ç”¨ `toml`ã€`serde_json`ã€`quick-xml` ç­‰è§£æå™¨
> - è‹¥å¤šä¸ªæ–‡ä»¶å­˜åœ¨ï¼ŒæŒ‰ä¸Šè¿°é¡ºåºå–ç¬¬ä¸€ä¸ªæœ‰æ•ˆå€¼
> - è‹¥å‡å¤±è´¥ï¼Œä½¿ç”¨é¡¹ç›®æ ¹ç›®å½•åä½œä¸º `project_name`

---

## **5. å…³é”®å®ç°ç»†èŠ‚**

### **5.1 é…ç½®æšä¸¾ï¼š`LLMProvider`**

```rust
#[derive(Debug, Clone, PartialEq, Eq, Serialize, Deserialize)]
pub enum LLMProvider {
    Moonshot,
    Mistral,
    OpenRouter,
    Gemini,
    Anthropic,
}

impl FromStr for LLMProvider {
    type Err = String;
    fn from_str(s: &str) -> Result<Self, Self::Err> {
        match s.to_lowercase().as_str() {
            "moonshot" => Ok(LLMProvider::Moonshot),
            "mistral" => Ok(LLMProvider::Mistral),
            "openrouter" => Ok(LLMProvider::OpenRouter),
            "gemini" => Ok(LLMProvider::Gemini),
            "anthropic" => Ok(LLMProvider::Anthropic),
            _ => Err(format!("Unsupported LLM provider: {}", s)),
        }
    }
}

impl Display for LLMProvider {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        write!(f, "{}", match self {
            LLMProvider::Moonshot => "moonshot",
            LLMProvider::Mistral => "mistral",
            LLMProvider::OpenRouter => "openrouter",
            LLMProvider::Gemini => "gemini",
            LLMProvider::Anthropic => "anthropic",
        })
    }
}
```

> âœ… **è®¾è®¡äº®ç‚¹**ï¼š
> - æ”¯æŒ **CLI å‚æ•°å­—ç¬¦ä¸²**ï¼ˆå¦‚ `--llm-provider mistral`ï¼‰ä¸ **TOML æšä¸¾å€¼**ï¼ˆ`provider = "mistral"`ï¼‰åŒå‘è½¬æ¢
> - `FromStr` å®ç°ç¡®ä¿é…ç½®æ–‡ä»¶æˆ– CLI è¾“å…¥é”™è¯¯æ—¶**æå‰æŠ¥é”™**ï¼Œè€Œéè¿è¡Œæ—¶å´©æºƒ
> - `Display` å®ç°ç”¨äºæ—¥å¿—è¾“å‡ºä¸æ€§èƒ½æŠ¥å‘Š

### **5.2 ç¯å¢ƒå˜é‡è‡ªåŠ¨æ³¨å…¥**

ç³»ç»Ÿåœ¨ `Config::from_env()` ä¸­è‡ªåŠ¨è¯»å–ä»¥ä¸‹ç¯å¢ƒå˜é‡å¹¶è¦†ç›–å¯¹åº”å­—æ®µï¼š

| ç¯å¢ƒå˜é‡ | å¯¹åº”å­—æ®µ | è¯´æ˜ |
|----------|----------|------|
| `LLM_API_KEY` | `llm.api_key` | ç”¨äºè®¤è¯ LLM æœåŠ¡ |
| `LLM_BASE_URL` | `llm.base_url` | è‡ªå®šä¹‰ API ç½‘å…³åœ°å€ |
| `LLM_PROVIDER` | `llm.provider` | å­—ç¬¦ä¸²è½¬æšä¸¾ |
| `LLM_MODEL` | `llm.model` | æŒ‡å®šæ¨¡å‹åç§° |
| `CACHE_TTL` | `cache.ttl_minutes` | ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰ |
| `NO_CACHE` | `cache.enabled` | è‹¥å­˜åœ¨åˆ™è®¾ä¸º `false` |

> âœ… **å®ç°æ–¹å¼**ï¼š
> ```rust
> if let Ok(val) = env::var("LLM_PROVIDER") {
>     if let Ok(provider) = val.parse::<LLMProvider>() {
>         config.llm.provider = provider;
>     }
> }
> ```

### **5.3 é»˜è®¤é…ç½®å®Œæ•´æ€§**

`Default` trait å®ç°æä¾›**å®Œæ•´ã€å®‰å…¨ã€å¯è¿è¡Œ**çš„é»˜è®¤å€¼ï¼Œç¡®ä¿å³ä½¿æ— ä»»ä½•é…ç½®æ–‡ä»¶ï¼Œç³»ç»Ÿä»å¯å¯åŠ¨ï¼š

```rust
impl Default for Config {
    fn default() -> Self {
        Self {
            project_path: PathBuf::from("."),
            output_path: PathBuf::from("./docs"),
            internal_path: PathBuf::from("./.deepwiki"),
            project_name: None,
            llm: LLMConfig {
                provider: LLMProvider::Mistral, // é»˜è®¤æä¾›å•†
                api_key: None,
                base_url: None,
                model: None,
                temperature: Some(0.3),
                max_tokens: Some(2048),
                timeout_seconds: 30,
            },
            cache: CacheConfig {
                enabled: true,
                cache_dir: PathBuf::from("./.deepwiki/cache"),
                ttl_minutes: 1440,
                enable_monitoring: true,
                max_cache_size_mb: 100,
            },
            preprocess: PreprocessConfig {
                ignore_patterns: vec![
                    ".git/".to_string(),
                    "target/".to_string(),
                    "node_modules/".to_string(),
                    "*.log".to_string(),
                ],
                max_concurrent_files: 16,
                supported_languages: vec![
                    Language::Rust,
                    Language::Python,
                    Language::JavaScript,
                    Language::TypeScript,
                    Language::Java,
                    Language::Kotlin,
                    Language::Vue,
                    Language::React,
                    Language::Svelte,
                ],
                extract_code_lines: true,
            },
            output: OutputConfig {
                format: OutputFormat::Markdown,
                include_summary: true,
                compress_output: false,
            },
        }
    }
}
```

> âœ… **æ„ä¹‰**ï¼š  
> ç”¨æˆ·æ‰§è¡Œ `deepwiki .` å³å¯å¯åŠ¨åˆ†æï¼Œæ— éœ€ä»»ä½•é…ç½®æ–‡ä»¶ï¼Œæå¤§æå‡æ˜“ç”¨æ€§ã€‚

---

## **6. ä¸å…¶ä»–æ¨¡å—çš„äº¤äº’**

| æ¨¡å— | ä¾èµ–é…ç½®é¡¹ | ç”¨é€” | äº¤äº’æ–¹å¼ |
|------|------------|------|----------|
| **LLMå®¢æˆ·ç«¯åŸŸ** | `llm.provider`, `llm.api_key`, `llm.model` | åˆå§‹åŒ–æä¾›å•†å®¢æˆ·ç«¯ã€è®¾ç½®è®¤è¯ | é€šè¿‡ `Config::llm` å­—æ®µæ³¨å…¥ |
| **ç¼“å­˜åŸŸ** | `cache.enabled`, `cache.cache_dir`, `cache.ttl_minutes` | æ§åˆ¶ç¼“å­˜å¼€å…³ã€è·¯å¾„ã€è¿‡æœŸç­–ç•¥ | é€šè¿‡ `Config::cache` ä¼ å…¥ `CacheManager::new()` |
| **é¢„å¤„ç†åŸŸ** | `preprocess.ignore_patterns`, `preprocess.max_concurrent_files`, `preprocess.supported_languages` | æ§åˆ¶æ–‡ä»¶æ‰«æèŒƒå›´ã€å¹¶å‘æ•°ã€è¯­è¨€æ”¯æŒ | ä¼ é€’ç»™ `StructureExtractor` å’Œ `LanguageProcessorManager` |
| **è¾“å‡ºåŸŸ** | `output.format`, `output.include_summary` | å†³å®šè¾“å‡ºæ ¼å¼ä¸æ˜¯å¦ç”Ÿæˆæ€»ç»“æŠ¥å‘Š | ä¼ é€’ç»™ `DiskOutlet` å’Œ `SummaryGenerator` |
| **å†…å­˜å­˜å‚¨åŸŸ** | æ— ç›´æ¥ä¾èµ– | ä½†æ‰€æœ‰ä¸Šä¸‹æ–‡é”®åï¼ˆå¦‚ `STUDIES_RESEARCH`ï¼‰ç”±é…ç½®é©±åŠ¨çš„æ¨¡å—å®šä¹‰ | é€šè¿‡ `Config` é—´æ¥å½±å“ä¸Šä¸‹æ–‡ç»“æ„ |

> âš ï¸ **æ³¨æ„**ï¼šé…ç½®ç®¡ç†åŸŸ**ä¸ä¸»åŠ¨è°ƒç”¨**å…¶ä»–æ¨¡å—ï¼Œä»…ä½œä¸º**é…ç½®æä¾›è€…**ï¼Œç¬¦åˆâ€œä¾èµ–å€’ç½®â€åŸåˆ™ã€‚

---

## **7. å¯æ‰©å±•æ€§ä¸æ¼”è¿›è®¾è®¡**

### **7.1 æ–°å¢é…ç½®é¡¹çš„è§„èŒƒ**

å½“éœ€æ–°å¢é…ç½®é¡¹æ—¶ï¼Œéµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. åœ¨ `Config` æˆ–å­ç»“æ„ä½“ä¸­æ·»åŠ å­—æ®µï¼ˆç±»å‹ä¸º `Option<T>`ï¼‰
2. å®ç° `Serialize` / `Deserialize`ï¼ˆè‡ªåŠ¨ç»§æ‰¿ï¼‰
3. åœ¨ `Default` ä¸­è®¾ç½®åˆç†é»˜è®¤å€¼
4. åœ¨ CLI è§£æå™¨ä¸­æ·»åŠ å¯¹åº”å‚æ•°ï¼ˆå¦‚ `--new-flag`ï¼‰
5. åœ¨ç¯å¢ƒå˜é‡ä¸­æ·»åŠ å¯¹åº”å˜é‡ï¼ˆå¦‚ `NEW_FLAG`ï¼‰
6. åœ¨æ–‡æ¡£ä¸­æ›´æ–°é…ç½®è¯´æ˜

> âœ… **ä¼˜åŠ¿**ï¼šæ–°å¢å­—æ®µ**æ— éœ€ä¿®æ”¹å·²æœ‰é€»è¾‘**ï¼Œæ—§ç‰ˆæœ¬é…ç½®æ–‡ä»¶ä»å¯åŠ è½½ï¼ˆSerde è‡ªåŠ¨å¿½ç•¥æœªçŸ¥å­—æ®µï¼‰ã€‚

### **7.2 æœªæ¥æ¼”è¿›æ–¹å‘**

| æ–¹å‘ | è¯´æ˜ |
|------|------|
| **é…ç½®éªŒè¯å™¨** | å¼•å…¥ `Validate` traitï¼Œå¯¹ `api_key` æ˜¯å¦ä¸ºç©ºã€`cache_dir` æ˜¯å¦å¯å†™ç­‰è¿›è¡Œè¿è¡Œæ—¶æ ¡éªŒ |
| **é…ç½®çƒ­é‡è½½** | ç›‘å¬é…ç½®æ–‡ä»¶å˜æ›´ï¼ŒåŠ¨æ€æ›´æ–°è¿è¡Œæ—¶é…ç½®ï¼ˆé€‚ç”¨äºé•¿æœŸè¿è¡ŒæœåŠ¡ï¼‰ |
| **é…ç½®æ¨¡æ¿ç”Ÿæˆ** | æä¾› `deepwiki --generate-config` å‘½ä»¤ï¼Œè‡ªåŠ¨ç”Ÿæˆå®Œæ•´ `config.toml` æ¨¡æ¿ |
| **é…ç½®åˆ†å±‚** | æ”¯æŒ `global.toml`ã€`project.toml`ã€`env.toml` å¤šçº§é…ç½®åˆå¹¶ |
| **é…ç½®æ–‡æ¡£åŒ–** | è‡ªåŠ¨ç”Ÿæˆé…ç½®å­—æ®µçš„ Markdown æ–‡æ¡£ï¼ˆåŸºäº `serde` æ³¨è§£ï¼‰ |

---

## **8. å®ç”¨æ€§ä¸æœ€ä½³å®è·µ**

### **8.1 æ¨èé…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼ˆ`config.toml`ï¼‰**

```toml
project_path = "./my-rust-project"
output_path = "./docs/generated"
internal_path = "./.deepwiki"

[llm]
provider = "moonshot"
api_key = "sk-xxx"
model = "moonshot-v1-128k"
temperature = 0.2
timeout_seconds = 60

[cache]
enabled = true
cache_dir = "./.deepwiki/cache"
ttl_minutes = 1440
enable_monitoring = true
max_cache_size_mb = 200

[preprocess]
ignore_patterns = [".git/", "target/", "node_modules/", "*.log", "test/"]
max_concurrent_files = 20
supported_languages = ["Rust", "Python", "JavaScript"]

[output]
format = "Markdown"
include_summary = true
compress_output = false
```

### **8.2 CLI ä½¿ç”¨ç¤ºä¾‹**

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®
deepwiki .

# æŒ‡å®šé¡¹ç›®è·¯å¾„ä¸è¾“å‡ºç›®å½•
deepwiki --project-path ./my-app --output-path ./docs

# ç¦ç”¨ç¼“å­˜ï¼Œä½¿ç”¨ç‰¹å®š LLM
deepwiki --no-cache --llm-provider mistral --model mistral-small

# è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆæ¨èç”¨äº CI/CDï¼‰
export LLM_API_KEY=xxx
export LLM_PROVIDER=Moonshot
deepwiki .
```

### **8.3 æ•…éšœæ’æŸ¥æŒ‡å—**

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| `Error: Unsupported LLM provider: "openai"` | CLI è¾“å…¥é”™è¯¯ | ä½¿ç”¨ `--llm-provider openrouter`ï¼ˆå½“å‰ä¸æ”¯æŒ OpenAIï¼‰ |
| `Cache directory not writable` | æƒé™ä¸è¶³ | æ£€æŸ¥ `cache_dir` è·¯å¾„æ˜¯å¦å­˜åœ¨ä¸”å¯å†™ï¼Œæˆ–ä½¿ç”¨ `--cache-dir /tmp/deepwiki` |
| `Project name not inferred` | é¡¹ç›®æ ¹ç›®å½•æ—  `Cargo.toml` ç­‰æ–‡ä»¶ | æ‰‹åŠ¨æŒ‡å®š `--project-name my-project` |
| `LLM API key is empty` | æœªè®¾ç½®ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶ | æ£€æŸ¥ `LLM_API_KEY` æ˜¯å¦å¯¼å‡ºï¼Œæˆ–åœ¨ `config.toml` ä¸­å¡«å†™ |

---

## **9. æ€»ç»“**

**é…ç½®ç®¡ç†åŸŸ**è™½ä¸ºç³»ç»Ÿä¸­æœ€â€œå¹³å‡¡â€çš„æ¨¡å—ï¼Œå´æ˜¯ `deepwiki-rs` å®ç°**é«˜å¯ç”¨ã€é«˜å¯ç»´æŠ¤ã€é«˜å¯æ‰©å±•**æ¶æ„çš„**å…³é”®æ”¯æŸ±**ã€‚å…¶è®¾è®¡ä½“ç°äº† Rust ç”Ÿæ€ä¸­â€œ**é›¶æˆæœ¬æŠ½è±¡**â€ä¸â€œ**å£°æ˜å¼é…ç½®**â€çš„ç²¾é«“ï¼š

- âœ… **ç±»å‹å®‰å…¨**ï¼šæ‰€æœ‰é…ç½®é¡¹ç¼–è¯‘æœŸæ ¡éªŒ  
- âœ… **çµæ´»è¦†ç›–**ï¼šå››å±‚ä¼˜å…ˆçº§ï¼Œé€‚åº”ä»å¼€å‘åˆ°ç”Ÿäº§çš„æ‰€æœ‰åœºæ™¯  
- âœ… **è‡ªåŠ¨æ¨æ–­**ï¼šå‡å°‘ç”¨æˆ·è®¤çŸ¥è´Ÿæ‹…ï¼Œæå‡ä½“éªŒ  
- âœ… **æ— ä¾èµ–**ï¼šç‹¬ç«‹ã€å¯æµ‹è¯•ã€å¯å¤ç”¨  
- âœ… **å¯æ¼”è¿›**ï¼šæ–°å¢é…ç½®é¡¹é›¶ä¾µå…¥  

> ğŸ“Œ **å»ºè®®**ï¼š  
> åœ¨å›¢é˜Ÿåä½œä¸­ï¼Œåº”å°† `config.toml` ä½œä¸ºé¡¹ç›®æ¶æ„æ–‡æ¡£çš„ä¸€éƒ¨åˆ†çº³å…¥ç‰ˆæœ¬æ§åˆ¶ï¼Œç¡®ä¿å›¢é˜Ÿæˆå‘˜ä½¿ç”¨ä¸€è‡´çš„åˆ†æç­–ç•¥ã€‚  
> åŒæ—¶ï¼Œå»ºè®®åœ¨ CI/CD æµç¨‹ä¸­é€šè¿‡ `deepwiki --no-cache --llm-provider mistral` ç¡®ä¿åˆ†æç»“æœå¯é‡ç°ã€‚

---

**ä¸‹ä¸€æ¨¡å—å»ºè®®é˜…è¯»**ï¼š[å†…å­˜å­˜å‚¨åŸŸ â€”â€” ç³»ç»Ÿçš„å”¯ä¸€æ•°æ®æ€»çº¿](#)  
**ç›¸å…³æ–‡ä»¶**ï¼š  
- `src/config.rs` â€”â€” æ ¸å¿ƒé…ç½®ç»“æ„ä½“ä¸åŠ è½½é€»è¾‘  
- `src/cli.rs` â€”â€” CLI å‚æ•°è§£æä¸ `to_config()` å®ç°  
- `src/types/config.rs` â€”â€” é…ç½®æ¨¡å‹å®šä¹‰ï¼ˆå¦‚ `LLMProvider`ï¼‰  
- `config.example.toml` â€”â€” é…ç½®æ¨¡æ¿å‚è€ƒï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰