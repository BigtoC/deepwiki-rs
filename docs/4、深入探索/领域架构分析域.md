# **é¢†åŸŸæ¶æ„åˆ†æåŸŸæŠ€æœ¯å®ç°æ–‡æ¡£**

---

## **1. æ¦‚è¿°**

**é¢†åŸŸæ¶æ„åˆ†æåŸŸ**ï¼ˆDomain Architecture Analysis Domainï¼‰æ˜¯ `deepwiki-rs` é¡¹ç›®ä¸­çš„æ ¸å¿ƒä¸šåŠ¡æ¨¡å—ä¹‹ä¸€ï¼Œè´Ÿè´£ä»é«˜å±‚æ¬¡è¯†åˆ«å’Œå®šä¹‰ç›®æ ‡ä»£ç åº“çš„é¢†åŸŸç»“æ„ã€ç³»ç»Ÿè¾¹ç•Œä¸å…³é”®å·¥ä½œæµã€‚è¯¥æ¨¡å—åŸºäº C4 æ¶æ„æ¨¡å‹ç†å¿µï¼Œé‡‡ç”¨å¤šæ™ºèƒ½ä½“åä½œæœºåˆ¶ï¼Œé€šè¿‡è‡ªé¡¶å‘ä¸‹çš„åˆ†å±‚åˆ†ææ–¹æ³•ï¼Œå°†åŸå§‹ä»£ç è½¬åŒ–ä¸ºå…·å¤‡åŠŸèƒ½ä»·å€¼å¯¼å‘çš„é¢†åŸŸåˆ’åˆ†æŠ¥å‘Šã€‚

æœ¬æ¨¡å—ä½äºç³»ç»Ÿâ€œç ”ç©¶é˜¶æ®µâ€ï¼ˆResearch Phaseï¼‰ï¼Œæ‰¿æ¥é¢„å¤„ç†é˜¶æ®µè¾“å‡ºçš„ä»£ç æ´å¯Ÿä¸ç»“æ„ä¿¡æ¯ï¼Œä¸ºåç»­æ–‡æ¡£åˆæˆé˜¶æ®µæä¾›è¯­ä¹‰ä¸°å¯Œçš„ä¸Šä¸‹æ–‡è¾“å…¥ï¼Œæ˜¯è¿æ¥ä»£ç ç†è§£ä¸æ–‡æ¡£ç”Ÿæˆçš„å…³é”®æ¡¥æ¢ã€‚

> âœ… **å®šä½è¯´æ˜**ï¼š  
> è¯¥æ¨¡å—ä¸å…³æ³¨å…·ä½“è¯­æ³•è§£ææˆ–å‡½æ•°çº§ç»†èŠ‚ï¼Œè€Œæ˜¯èšç„¦äº**ç³»ç»Ÿçº§æŠ½è±¡èƒ½åŠ›**ï¼Œæ—¨åœ¨å›ç­”ï¼šâ€œè¿™ä¸ªç³»ç»Ÿç”±å“ªäº›é«˜é˜¶åŠŸèƒ½é¢†åŸŸæ„æˆï¼Ÿå®ƒä»¬å¦‚ä½•åä½œï¼Ÿæ•´ä½“æ¶æ„å‘ˆç°ä½•ç§æ¨¡å¼ï¼Ÿâ€

---

## **2. æ ¸å¿ƒèŒè´£ä¸ç›®æ ‡**

### **2.1 ä¸»è¦èŒè´£**
| èŒè´£ | æè¿° |
|------|------|
| **ç³»ç»Ÿä¸Šä¸‹æ–‡å»ºæ¨¡** | ç¡®å®šé¡¹ç›®ç±»å‹ã€ç”¨æˆ·è§’è‰²ã€å¤–éƒ¨ä¾èµ–åŠç³»ç»Ÿè¾¹ç•Œï¼Œå»ºç«‹ C1 å±‚çº§è§†å›¾ |
| **é¢†åŸŸæ¨¡å—è¯†åˆ«** | åŸºäºåŠŸèƒ½ä»·å€¼è€ŒéæŠ€æœ¯å®ç°ï¼Œè¯†åˆ«å¹¶åˆ’åˆ†é«˜å±‚æ¬¡ä¸šåŠ¡é¢†åŸŸåŠå…¶å­æ¨¡å— |
| **æ¶æ„æ¨¡å¼åˆ†æ** | æå–æ•´ä½“è½¯ä»¶æ¶æ„ç‰¹å¾ï¼Œç”Ÿæˆ Mermaid å¯è§†åŒ–æè¿° |
| **æ ¸å¿ƒæµç¨‹æ¢³ç†** | åˆ†æä¸»å¹²ä¸šåŠ¡æµç¨‹ï¼Œæ˜ç¡®æ‰§è¡Œè·¯å¾„ä¸è·¨é¢†åŸŸäº¤äº’ |
| **è¾¹ç•Œæ¥å£æ¢æµ‹** | è¯†åˆ« CLIã€APIã€é…ç½®ç­‰å¯¹å¤–æš´éœ²çš„è°ƒç”¨æ¥å£ |
| **å…³é”®æ¨¡å—æ·±å…¥æ´å¯Ÿ** | å¯¹é‡ç‚¹é¢†åŸŸè¿›è¡Œå¾®è§‚å±‚é¢çš„æŠ€æœ¯æ–¹æ¡ˆå‰–æ |

### **2.2 è®¾è®¡ç›®æ ‡**
- âœ… **åŠŸèƒ½å¯¼å‘**ï¼šå¼ºè°ƒâ€œåšä»€ä¹ˆâ€è€Œéâ€œæ€ä¹ˆåšâ€ï¼Œé¿å…é™·å…¥æŠ€æœ¯æ ˆç»†èŠ‚
- âœ… **ç»“æ„åŒ–è¾“å‡º**ï¼šæ‰€æœ‰åˆ†æç»“æœå‡ä»¥ JSON Schema å®šä¹‰çš„ç»“æ„åŒ–æ•°æ®è¿”å›
- âœ… **å¯è¿½æº¯æ€§**ï¼šæ”¯æŒä»æœ€ç»ˆæ–‡æ¡£åå‘è¿½è¸ªè‡³åŸå§‹ä»£ç æ–‡ä»¶
- âœ… **ç½®ä¿¡åº¦è¯„ä¼°**ï¼šæ¯ä¸ªåˆ†æç»“æœé™„å¸¦ç½®ä¿¡è¯„åˆ†ï¼Œè¾…åŠ©ç”¨æˆ·åˆ¤æ–­å¯é æ€§

---

## **3. æ¨¡å—ç»„æˆä¸ç»„ä»¶è¯¦è§£**

é¢†åŸŸæ¶æ„åˆ†æåŸŸç”±å¤šä¸ªéµå¾ªç»Ÿä¸€æ¥å£çš„æ™ºèƒ½ä½“ï¼ˆAgentï¼‰æ„æˆï¼Œå„ç»„ä»¶æŒ‰ C4 æ¨¡å‹å±‚çº§ç»„ç»‡ï¼Œå½¢æˆæ¸…æ™°çš„åˆ†ææµæ°´çº¿ã€‚

### **3.1 ç»„ä»¶æ¦‚è§ˆ**

| ç»„ä»¶åç§° | æ–‡ä»¶è·¯å¾„ | æ‰§è¡Œé¡ºåº | è¾“å‡ºç±»å‹ | LLM è°ƒç”¨æ¨¡å¼ |
|--------|--------|---------|----------|-------------|
| `SystemContextResearcher` | `research/agents/system_context_researcher.rs` | ç¬¬ä¸€é˜¶æ®µï¼ˆC1ï¼‰ | `SystemContextReport` | `Extract` |
| `DomainModulesDetector` | `research/agents/domain_modules_detector.rs` | ç¬¬äºŒé˜¶æ®µï¼ˆC2ï¼‰ | `DomainModulesReport` | `Extract` |
| `ArchitectureResearcher` | `research/agents/architecture_researcher.rs` | ç¬¬äºŒé˜¶æ®µï¼ˆC2ï¼‰ | `String` (Mermaid) | `PromptWithTools` |
| `WorkflowResearcher` | `research/agents/workflow_researcher.rs` | ç¬¬äºŒé˜¶æ®µï¼ˆC2ï¼‰ | `WorkflowReport` | `Extract` |
| `KeyModulesInsight` | `research/agents/key_modules_insight.rs` | ç¬¬ä¸‰é˜¶æ®µï¼ˆC3/C4ï¼‰ | `Vec<KeyModuleReport>` | `Extract` |
| `BoundaryAnalyzer` | `research/agents/boundary_analyzer.rs` | ç¬¬ä¸‰é˜¶æ®µï¼ˆC3/C4ï¼‰ | `BoundaryAnalysisReport` | `Extract` |

---

### **3.2 å…³é”®ç»„ä»¶è¯¦ç»†è¯´æ˜**

#### **(1) SystemContextResearcher â€”â€” ç³»ç»Ÿä¸Šä¸‹æ–‡ç ”ç©¶å‘˜**

- **ä½œç”¨**ï¼šå®Œæˆ C1 ç³»ç»Ÿä¸Šä¸‹æ–‡å»ºæ¨¡ï¼Œç¡®å®šé¡¹ç›®çš„å®è§‚å®šä½ã€‚
- **è¾“å…¥æ¥æº**ï¼š
  - `PROJECT_STRUCTURE`ï¼šé¡¹ç›®ç›®å½•ç»“æ„
  - `CODE_INSIGHTS`ï¼šå‰50ä¸ªæœ€é‡è¦çš„ä»£ç æ´å¯Ÿ
  - `README_CONTENT`ï¼ˆå¯é€‰ï¼‰ï¼šäººå·¥ç¼–å†™çš„è¯´æ˜æ–‡æ¡£
- **è¾“å‡ºå†…å®¹**ï¼š
  ```rust
  struct SystemContextReport {
      project_name: String,
      project_type: ProjectType, // å¦‚ BackendService, CLITool ç­‰
      target_users: Vec<UserPersona>,
      external_systems: Vec<ExternalSystem>,
      system_boundary: SystemBoundary,
      confidence_score: f64,
  }
  ```
- **æç¤ºè¯ç­–ç•¥**ï¼š
  - ä½¿ç”¨ `LLMCallMode::Extract` å¼ºåˆ¶è¿”å›ç»“æ„åŒ– JSON
  - å¼ºè°ƒâ€œè°åœ¨ä½¿ç”¨å®ƒï¼Ÿä¸å“ªäº›å¤–éƒ¨ç³»ç»Ÿäº¤äº’ï¼Ÿç³»ç»Ÿè¾¹ç•Œåœ¨å“ªé‡Œï¼Ÿâ€
- **é‡è¦æ€§**ï¼šä½œä¸ºåç»­æ‰€æœ‰åˆ†æçš„åŸºç¡€è¾“å…¥ï¼Œå…¶å‡†ç¡®æ€§ç›´æ¥å½±å“æ•´ä½“è´¨é‡ã€‚

---

#### **(2) DomainModulesDetector â€”â€” é¢†åŸŸæ¨¡å—æ¢æµ‹å™¨ï¼ˆæ ¸å¿ƒï¼‰**

- **ä½œç”¨**ï¼šæ‰§è¡Œé¢†åŸŸé©±åŠ¨è®¾è®¡ä¸­çš„æˆ˜ç•¥å»ºæ¨¡ï¼Œè¯†åˆ«ç³»ç»Ÿçš„é«˜é˜¶åŠŸèƒ½é¢†åŸŸã€‚
- **è¾“å…¥æ¥æº**ï¼š
  - `ResearchResult("SystemContextResearcher")`
  - `DEPENDENCY_ANALYSIS`ï¼šæ¨¡å—é—´ä¾èµ–å…³ç³»å›¾è°±
  - `CODE_INSIGHTS`ï¼šæ ¸å¿ƒæ–‡ä»¶çš„åŠŸèƒ½æ‘˜è¦
  - `PROJECT_STRUCTURE`ï¼ˆå¯é€‰ï¼‰
- **è¾“å‡ºå†…å®¹**ï¼š
  ```rust
  struct DomainModulesReport {
      domain_modules: Vec<DomainModule>,        // é«˜å±‚æ¬¡é¢†åŸŸåˆ—è¡¨
      domain_relations: Vec<DomainRelation>,    // é¢†åŸŸé—´ä¾èµ–/è°ƒç”¨å…³ç³»
      business_flows: Vec<BusinessFlow>,        // æ ¸å¿ƒæ‰§è¡Œæµç¨‹
      architecture_summary: String,             // æ¶æ„ç‰¹ç‚¹æ€»ç»“
      confidence_score: f64,
  }
  ```
- **åˆ†æåŸåˆ™**ï¼ˆè§ `prompt_template.closing_instruction`ï¼‰ï¼š
  - è‡ªé¡¶å‘ä¸‹ï¼Œå…ˆé¢†åŸŸåæ¨¡å—
  - é¢†åŸŸåˆ’åˆ†ä½“ç°**åŠŸèƒ½ä»·å€¼**ï¼ŒéæŠ€æœ¯å®ç°
  - åˆç†æŠ½è±¡ï¼Œé¿å…è¿‡åº¦ç»†åŒ–
  - å…³æ³¨æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä¸å…³é”®ä¾èµ–
- **åå¤„ç†è¡Œä¸º**ï¼š
  - æ‰“å°ç»Ÿè®¡æ‘˜è¦ï¼šé¢†åŸŸæ•°é‡ã€å­æ¨¡å—æ€»æ•°ã€å…³ç³»æ•°ã€ç½®ä¿¡åº¦
  - å­˜å‚¨è‡³å†…å­˜ä½œç”¨åŸŸ `STUDIES_RESEARCH`

---

#### **(3) ArchitectureResearcher â€”â€” æ¶æ„ç ”ç©¶å‘˜**

- **ä½œç”¨**ï¼šåŸºäºå·²è¯†åˆ«çš„é¢†åŸŸç»“æ„ï¼Œç”Ÿæˆå¯è§†åŒ–ç³»ç»Ÿæ¶æ„å›¾ï¼ˆMermaid æ ¼å¼ï¼‰ã€‚
- **è¾“å…¥æ¥æº**ï¼š
  - `SystemContextResearcher` ç»“æœ
  - `DomainModulesDetector` ç»“æœ
  - ï¼ˆå¯é€‰ï¼‰é¡¹ç›®ç»“æ„ä¸ä¾èµ–åˆ†æ
- **è¾“å‡ºå½¢å¼**ï¼šçº¯æ–‡æœ¬å­—ç¬¦ä¸²ï¼ŒåŒ…å« Mermaid å›¾è¡¨ä»£ç 
  ```mermaid
  graph TD
      A[ç”¨æˆ·ç®¡ç†åŸŸ] --> B[è®¤è¯æœåŠ¡]
      B --> C[(æ•°æ®åº“)]
  ```
- **è°ƒç”¨æ¨¡å¼**ï¼š`LLMCallMode::PromptWithTools`ï¼Œå…è®¸ LLM è°ƒç”¨å†…ç½®å·¥å…·è¾…åŠ©æ¨ç†
- **åˆ†æè¦æ±‚**ï¼š
  - é‡ç‚¹ä½“ç°æ ¸å¿ƒç»„ä»¶ä¸äº¤äº’æ¨¡å¼
  - ç¬¦åˆ C4 å®¹å™¨è§†å›¾æ ‡å‡†
  - æ”¯æŒè‡ªåŠ¨å¸ƒå±€å»ºè®®

---

#### **(4) WorkflowResearcher â€”â€” å·¥ä½œæµç ”ç©¶å‘˜**

- **ä½œç”¨**ï¼šæå–ç³»ç»Ÿçº§ä¸»å¹²å·¥ä½œæµç¨‹ï¼Œå¦‚â€œé¡¹ç›®åˆ†ææµç¨‹â€ã€â€œä»£ç æ„å»ºæµç¨‹â€ç­‰ã€‚
- **è¾“å…¥æ¥æº**ï¼š
  - `SystemContextResearcher`
  - `DomainModulesDetector`
  - `CODE_INSIGHTS`
- **è¾“å‡ºå†…å®¹**ï¼š
  ```rust
  struct WorkflowReport {
      main_workflow: Workflow,
      other_important_workflows: Vec<Workflow>,
  }

  struct Workflow {
      name: String,
      description: String,
      flowchart_mermaid: String,
  }
  ```
- **è§†è§’è¦æ±‚**ï¼šä»**åŠŸèƒ½åœºæ™¯**å‡ºå‘ï¼Œæè¿°ç”¨æˆ·æˆ–ç³»ç»Ÿè§¦å‘çš„å…³é”®è·¯å¾„ï¼Œè€Œéä»£ç è°ƒç”¨é“¾ã€‚

---

#### **(5) KeyModulesInsight â€”â€” å…³é”®æ¨¡å—æ´å¯Ÿå™¨**

- **ä½œç”¨**ï¼šå¯¹æ¯ä¸ªè¯†åˆ«å‡ºçš„é¢†åŸŸæ¨¡å—è¿›è¡Œæ·±åº¦æŠ€æœ¯å‰–æï¼Œç”Ÿæˆå¾®è§‚çº§æŠ€æœ¯æ–‡æ¡£è‰ç¨¿ã€‚
- **æ‰§è¡Œæ–¹å¼**ï¼š
  - å¹¶å‘æ‰§è¡Œï¼ˆå— `config.llm.max_parallels` æ§åˆ¶ï¼‰
  - ä½¿ç”¨ `do_parallel_with_limit` å®ç°å¹¶å‘é™åˆ¶
- **è¾“å…¥æ¥æº**ï¼š
  - `SystemContextResearcher`
  - `DomainModulesDetector`
- **å†…éƒ¨é€»è¾‘**ï¼š
  1. è·å– `DomainModulesReport`
  2. éå†æ¯ä¸ª `DomainModule`ï¼Œç­›é€‰å…¶å…³è”çš„ `CodeInsight`
  3. ä¸ºæ¯ä¸ªé¢†åŸŸæ„é€ ç‹¬ç«‹ Promptï¼Œè°ƒç”¨ LLM è¿›è¡Œæ·±åº¦åˆ†æ
  4. ç»“æœå­˜å‚¨ä¸º `KeyModuleReport`ï¼Œå«æ¥å£å®šä¹‰ã€äº¤äº’æ–¹å¼ã€å®ç°ç»†èŠ‚ç­‰
- **å¤±è´¥å®¹å¿**ï¼šå•ä¸ªé¢†åŸŸåˆ†æå¤±è´¥ä¸å½±å“æ•´ä½“æµç¨‹ç»§ç»­æ‰§è¡Œã€‚

---

#### **(6) BoundaryAnalyzer â€”â€” è¾¹ç•Œæ¥å£åˆ†æå¸ˆ**

- **ä½œç”¨**ï¼šè¯†åˆ«ç³»ç»Ÿå¯¹å¤–æš´éœ²çš„è°ƒç”¨æ¥å£ï¼ŒåŒ…æ‹¬ CLIã€APIã€é…ç½®é¡¹ç­‰ã€‚
- **è¾“å…¥æ¥æº**ï¼š
  - `PROJECT_STRUCTURE`
  - `DEPENDENCY_ANALYSIS`
  - `SystemContextResearcher`
- **ç‰¹æ®Šå¤„ç†æœºåˆ¶**ï¼š
  - è‡ªå®šä¹‰ `provide_custom_prompt_content()` æ–¹æ³•æ³¨å…¥è¾¹ç•Œç›¸å…³ä»£ç 
  - ä½¿ç”¨ `filter_boundary_code_insights()` ç­›é€‰ç‰¹å®šç”¨é€”ç±»å‹çš„ä»£ç ï¼š
    ```rust
    matches!(insight.code_dossier.code_purpose,
        CodePurpose::Entry | Api | Config | Router
    )
    ```
  - æŒ‰é‡è¦æ€§æ’åºï¼Œä¿ç•™ Top 50
- **è¾“å‡ºç»“æ„**ï¼š
  ```rust
  struct BoundaryAnalysisReport {
      cli_boundaries: Vec<CLIBoundary>,
      api_boundaries: Vec<APIBoundary>,
      integration_suggestions: Vec<IntegrationSuggestion>,
      confidence_score: f64,
  }
  ```
- **åº”ç”¨åœºæ™¯**ï¼šä¸ºæ–°å¼€å‘è€…æä¾›å¿«é€Ÿé›†æˆæŒ‡å—ä¸å®‰å…¨å»ºè®®ã€‚

---

## **4. æ•°æ®æµä¸æ‰§è¡Œæµç¨‹**

### **4.1 æ‰§è¡Œé¡ºåºï¼ˆC1 â†’ C2 â†’ C3/C4ï¼‰**

```text
[é¢„å¤„ç†é˜¶æ®µ]
     â†“
SystemContextResearcher  â† è¾“å…¥ï¼šProjectStructure + CodeInsights
     â†“
DomainModulesDetector    â† è¾“å…¥ï¼šSystemContext + Dependencies + CodeInsights
     â†“
â”œâ”€ ArchitectureResearcher â† è¾“å…¥ï¼šSystemContext + DomainModules
â”œâ”€ WorkflowResearcher     â† è¾“å…¥ï¼šSystemContext + DomainModules + CodeInsights
â””â”€ KeyModulesInsight      â† è¾“å…¥ï¼šSystemContext + DomainModulesï¼ˆå¹¶å‘æ‰§è¡Œï¼‰
     â†“
BoundaryAnalyzer         â† è¾“å…¥ï¼šProjectStructure + Dependencies + SystemContext
```

è¯¥æµç¨‹ç”± `ResearchOrchestrator::execute_research_pipeline()` ç¼–æ’æ‰§è¡Œã€‚

---

### **4.2 å†…å­˜ä½œç”¨åŸŸç®¡ç†**

æ‰€æœ‰ç ”ç©¶æˆæœç»Ÿä¸€å†™å…¥ `MemoryScope::STUDIES_RESEARCH`ï¼š

| é”®åï¼ˆKeyï¼‰ | å¯¹åº” Agent | æ•°æ®ç±»å‹ |
|------------|-----------|---------|
| `"SystemContextResearcher"` | `SystemContextResearcher` | `SystemContextReport` |
| `"DomainModulesDetector"`   | `DomainModulesDetector`   | `DomainModulesReport` |
| `"ArchitectureResearcher"`  | `ArchitectureResearcher`  | `String` |
| `"WorkflowResearcher"`      | `WorkflowResearcher`      | `WorkflowReport` |
| `"KeyModulesInsight"`       | `KeyModulesInsight`       | `Vec<KeyModuleReport>` |
| `"BoundaryAnalyzer"`        | `BoundaryAnalyzer`        | `BoundaryAnalysisReport` |

> ğŸ“Œ **è®¿é—®æ–¹å¼**ï¼šé€šè¿‡ `GeneratorContext.get_research(&agent_type)` å¼‚æ­¥è·å–ã€‚

---

## **5. æŠ€æœ¯å®ç°æœºåˆ¶**

### **5.1 ç»Ÿä¸€ Agent æ¥å£ï¼š`StepForwardAgent`**

æ‰€æœ‰åˆ†ææ™ºèƒ½ä½“å®ç°ç»Ÿä¸€ traitï¼š

```rust
#[async_trait]
pub trait StepForwardAgent: Send + Sync {
    type Output: JsonSchema + Deserialize + Serialize;

    fn agent_type(&self) -> String;
    fn memory_scope_key(&self) -> String;
    fn data_config(&self) -> AgentDataConfig;
    fn prompt_template(&self) -> PromptTemplate;

    async fn execute(&self, context: &GeneratorContext) -> Result<Self::Output>;
    fn post_process(&self, result: &Self::Output, ctx: &GeneratorContext) -> Result<()>;
}
```

æ­¤è®¾è®¡å®ç°äº†ï¼š
- âœ… **æ ‡å‡†åŒ–æ‰§è¡Œæµç¨‹**
- âœ… **è‡ªåŠ¨åŒ–æ•°æ®éªŒè¯**ï¼ˆæ£€æŸ¥å¿…éœ€è¾“å…¥æ˜¯å¦å­˜åœ¨ï¼‰
- âœ… **ç»Ÿä¸€æ—¥å¿—ä¸ç¼“å­˜ç®¡ç†**
- âœ… **çµæ´»æ‰©å±•æ€§**

---

### **5.2 æç¤ºå·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰ç­–ç•¥**

#### **é€šç”¨æ¨¡æ¿ç»“æ„**
```rust
PromptTemplate {
    system_prompt: "ä½ æ˜¯ä¸“ä¸šçš„è½¯ä»¶æ¶æ„åˆ†æå¸ˆ...",
    opening_instruction: "åŸºäºä»¥ä¸‹è°ƒç ”ææ–™ï¼Œè¿›è¡Œé«˜å±‚æ¬¡æ¶æ„åˆ†æï¼š",
    closing_instruction: "## åˆ†æè¦æ±‚ï¼š\n- é‡‡ç”¨è‡ªé¡¶å‘ä¸‹æ–¹æ³•\n- é¢†åŸŸåˆ’åˆ†ä½“ç°åŠŸèƒ½ä»·å€¼...",
    llm_call_mode: LLMCallMode::Extract,
    formatter_config: FormatterConfig { ... },
}
```

#### **æ ¼å¼åŒ–æ§åˆ¶ï¼ˆFormatterConfigï¼‰**
| å‚æ•° | è¯´æ˜ |
|------|------|
| `code_insights_limit` | é»˜è®¤å– Top 50 æœ€é‡è¦çš„ä»£ç æ´å¯Ÿ |
| `include_source_code` | æ˜¯å¦åŒ…å«æºç ç‰‡æ®µï¼ˆä»… `BoundaryAnalyzer` å¼€å¯ï¼‰ |
| `only_directories_when_files_more_than` | æ–‡ä»¶è¿‡å¤šæ—¶ä»…æ˜¾ç¤ºç›®å½•æ ‘ |
| `enable_compression` | å¯ç”¨æ™ºèƒ½å‹ç¼©é˜²æ­¢è¶…é•¿ä¸Šä¸‹æ–‡ |

---

### **5.3 ç±»å‹ç³»ç»Ÿæ”¯æ’‘ï¼ˆTypesï¼‰**

å…³é”®ç»“æ„ä½“å®šä¹‰äº `src/generator/research/types.rs`ï¼Œå…¨éƒ¨å®ç° `JsonSchema` ä»¥ä¾¿ LLM ç»“æ„åŒ–æå–ï¼š

- `DomainModule`: é«˜å±‚æ¬¡ä¸šåŠ¡é¢†åŸŸ
- `SubModule`: é¢†åŸŸå†…çš„å…·ä½“å®ç°å•å…ƒ
- `DomainRelation`: é¢†åŸŸé—´ä¾èµ–å…³ç³»ï¼ˆå«å¼ºåº¦è¯„åˆ†ï¼‰
- `BusinessFlow`: æ ¸å¿ƒåŠŸèƒ½æµç¨‹ï¼ˆå«æ­¥éª¤ä¸å…¥å£ç‚¹ï¼‰

è¿™äº›ç±»å‹æ„æˆäº†é¢†åŸŸçŸ¥è¯†çš„å…ƒæ¨¡å‹ï¼Œç¡®ä¿åˆ†æç»“æœå…·å¤‡ä¸€è‡´æ€§å’Œæœºå™¨å¯è¯»æ€§ã€‚

---

## **6. ä¸å…¶ä»–æ¨¡å—çš„äº¤äº’å…³ç³»**

| ä¾èµ–æ–¹å‘ | æ¥æºæ¨¡å— | äº¤äº’æ–¹å¼ | è¯´æ˜ |
|--------|--------|--------|------|
| â† | **ä»£ç æ™ºèƒ½åˆ†æåŸŸ** | è¯»å– `PREPROCESS` å†…å­˜æ•°æ® | è·å– `CodeInsight`, `RelationshipAnalysis`, `ProjectStructure` |
| â† | **é…ç½®ä¸çŠ¶æ€ç®¡ç†åŸŸ** | æ³¨å…¥ `GeneratorContext` | è·å– `config` ä¸­çš„ LLM è®¾ç½®ã€ç›®æ ‡è¯­è¨€åå¥½ç­‰ |
| â†’ | **æ™ºèƒ½æ–‡æ¡£ç”ŸæˆåŸŸ** | å†™å…¥ `STUDIES_RESEARCH` å†…å­˜ | æä¾› `DomainModulesReport` ç­‰ç”¨äºæ–‡æ¡£åˆæˆ |
| â†” | **å¤§è¯­è¨€æ¨¡å‹äº¤äº’åŸŸ** | è°ƒç”¨ `LLMClient` | å‘èµ· `extract<T>()`, `prompt()`, `prompt_with_tools()` è¯·æ±‚ |

---

## **7. æ€»ç»“ä¸ä¼˜åŠ¿**

### **7.1 æ¶æ„ä¼˜åŠ¿**
| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **åˆ†å±‚æ¸…æ™°** | ä¸¥æ ¼éµå¾ª C4 æ¨¡å‹å±‚çº§ï¼Œé€å±‚é€’è¿›åˆ†æ |
| **èŒè´£åˆ†ç¦»** | æ¯ä¸ª Agent ä¸“æ³¨å•ä¸€ä»»åŠ¡ï¼Œé™ä½å¤æ‚åº¦ |
| **æ•°æ®é©±åŠ¨** | æ‰€æœ‰å†³ç­–åŸºäºå‰æœŸåˆ†æç»“æœï¼Œä¿è¯ä¸€è‡´æ€§ |
| **å¯æ’æ‹”è®¾è®¡** | æ–°å¢åˆ†æç»´åº¦åªéœ€å®ç° `StepForwardAgent` |
| **å¯è§‚æµ‹æ€§å¼º** | å®æ—¶æ‰“å°è¿›åº¦ã€ç»Ÿè®¡ä¿¡æ¯ä¸ç½®ä¿¡åº¦ |

### **7.2 åº”ç”¨ä»·å€¼**
- **è½¯ä»¶æ¶æ„å¸ˆ**ï¼šå¿«é€ŸæŒæ¡é—ç•™ç³»ç»Ÿæ•´ä½“ç»“æ„
- **å¼€å‘å·¥ç¨‹å¸ˆ**ï¼šç†è§£æ¨¡å—èŒè´£ä¸è°ƒç”¨å…³ç³»
- **æŠ€æœ¯è´Ÿè´£äºº**ï¼šè¯„ä¼°é¡¹ç›®å¥åº·åº¦ä¸çŸ¥è¯†æ²‰æ·€æ°´å¹³

---

## **8. å¯ä¼˜åŒ–æ–¹å‘å»ºè®®**

| æ–¹å‘ | å»ºè®® |
|------|------|
| **å¢å¼ºåé¦ˆé—­ç¯** | æ”¯æŒç”¨æˆ·æ ‡æ³¨ä¿®æ­£é¢†åŸŸåˆ’åˆ†ï¼Œç”¨äºæç¤ºè¯è¿­ä»£ä¼˜åŒ– |
| **å¼•å…¥é™æ€åˆ†æè§„åˆ™** | ç»“åˆ AST åˆ†æè¡¥å…… LLM åˆ¤æ–­ç›²åŒºï¼ˆå¦‚å¾ªç¯ä¾èµ–æ£€æµ‹ï¼‰ |
| **æ”¯æŒé¢†åŸŸæ˜ å°„é…ç½®** | å…è®¸ç”¨æˆ·é¢„å®šä¹‰é¢†åŸŸåŒ¹é…è§„åˆ™ï¼ˆæ­£åˆ™è·¯å¾„â†’é¢†åŸŸåï¼‰ |
| **å¢åŠ å› æœæ¨ç†èƒ½åŠ›** | åœ¨ `WorkflowResearcher` ä¸­å¼•å…¥å› æœé“¾åˆ†æ |
| **æ€§èƒ½ä¼˜åŒ–** | å¯¹ `KeyModulesInsight` æ·»åŠ ç¼“å­˜ç²’åº¦æ§åˆ¶ï¼Œé¿å…é‡å¤åˆ†æ |

--- 

> **æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2025-10-13 06:16:58 (UTC)  
> **åˆ†æä¾æ®**: `deepwiki-rs` é¡¹ç›®æºç ä¸è°ƒç ”ææ–™ç»¼åˆåˆ†æ  
> **ä½œè€…**: è½¯ä»¶æ¶æ„æŠ€æœ¯æ–‡æ¡£ä¸“å®¶