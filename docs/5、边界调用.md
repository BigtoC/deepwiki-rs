# 系统边界接口文档

本文档描述了系统的外部调用接口，包括CLI命令、API端点、配置参数等边界机制。

## 命令行接口 (CLI)

### litho

**描述**: DeepWiki-RS (Litho) 是一个由Rust与AI驱动的项目知识库生成引擎，能够智能分析项目结构、识别核心模块，并生成专业的架构文档。

**源文件**: `src/cli.rs`

**参数**:

- `project_path` (PathBuf): 必需 - 项目路径，默认为当前目录
- `output_path` (PathBuf): 必需 - 输出路径，默认为./litho.docs

**选项**:

- `config, c`(Option<PathBuf>): 可选 - 配置文件路径
- `name, n`(Option<String>): 可选 - 项目名称
- `skip_preprocessing`(bool): 可选 - 是否跳过项目预处理 (默认: `false`)
- `skip_research`(bool): 可选 - 是否跳过调研文档生成 (默认: `false`)
- `skip_documentation`(bool): 可选 - 是否跳过最终文档生成 (默认: `false`)
- `verbose, v`(bool): 可选 - 是否启用详细日志 (默认: `false`)
- `model_efficient`(Option<String>): 可选 - 高能效模型名称
- `model_powerful`(Option<String>): 可选 - 高质量模型名称
- `llm_api_base_url`(Option<String>): 可选 - LLM API基地址
- `llm_api_key`(Option<String>): 可选 - LLM API KEY
- `max_tokens`(Option<u32>): 可选 - 最大tokens数
- `temperature`(Option<f64>): 可选 - 温度参数
- `max_parallels`(Option<usize>): 可选 - 最大并行数
- `llm_provider`(Option<String>): 可选 - LLM Provider类型
- `target_language`(Option<String>): 可选 - 目标语言
- `disable_preset_tools`(bool): 可选 - 是否禁用预设工具 (默认: `false`)
- `no_cache`(bool): 可选 - 是否禁用缓存 (默认: `false`)
- `force_regenerate`(bool): 可选 - 是否强制重新生成（清除缓存） (默认: `false`)

**使用示例**:

```bash
litho --project-path ./my-project --output-path ./docs --target-language zh
```

```bash
litho -n "My Awesome Project" --llm-provider deepseek --model-powerful deepseek-chat --llm-api-key sk-xxxxx
```

```bash
litho --skip-preprocessing --skip-documentation --verbose
```

```bash
litho --config ./litho.toml --no-cache
```

## 集成建议

### CLI集成

提供最佳实践来集成和使用CLI工具。

**示例代码**:

```
use std::process::Command;

fn generate_docs(project_path: &str, output_path: &str, language: &str) -> Result<(), Box<dyn std::error::Error>> {
    let status = Command::new("litho")
        .arg("--project-path")
        .arg(project_path)
        .arg("--output-path")
        .arg(output_path)
        .arg("--target-language")
        .arg(language)
        .arg("--llm-api-key")
        .arg(std::env::var("LITHO_LLM_API_KEY")?)
        .status()?;

    if status.success() {
        println!("文档生成成功!");
    } else {
        eprintln!("文档生成失败");
    }
    Ok(())
}
```

**最佳实践**:

- 在CI/CD流水线中调用litho CLI自动生成最新文档
- 使用--config指定统一的配置文件以保证团队一致性
- 通过环境变量LITHO_LLM_API_KEY管理API密钥，避免硬编码
- 利用--no-cache和--force-regenerate选项进行调试和验证

### 配置管理

指导如何创建和使用配置文件。

**示例代码**:

```
# litho.toml 示例配置
project_name = "My Project"
target_language = "zh"
analyze_dependencies = true
identify_components = true

[llm]
provider = "deepseek"
api_key = "sk-xxxxx"
api_base_url = "https://api.deepseek.com/v1"
model_efficient = "deepseek-coder-1.3b"
model_powerful = "deepseek-chat"
temperature = 0.1
max_parallels = 5

[cache]
enabled = true
expire_hours = 8760
```

**最佳实践**:

- 为不同环境（开发、测试、生产）维护独立的配置文件
- 将包含敏感信息的配置文件添加到.gitignore
- 使用默认值减少配置复杂度
- 定期审查excluded_dirs和excluded_extensions列表以优化性能

### 安全建议

识别潜在的安全风险并提供缓解策略。

**示例代码**:

```
import os
from cryptography.fernet import Fernet

# 在实际应用中，应使用更安全的方式管理密钥
def load_encrypted_api_key():
    key = os.getenv('ENCRYPTION_KEY')
    encrypted_key = os.getenv('ENCRYPTED_LLM_API_KEY')
    if key and encrypted_key:
        f = Fernet(key.encode())
        return f.decrypt(encrypted_key.encode()).decode()
    return None
```

**最佳实践**:

- 绝不将LLM API密钥硬编码在源代码或配置文件中
- 使用环境变量或专用的秘密管理服务（如Hashicorp Vault）存储敏感凭证
- 为API密钥设置最小权限原则和访问限制
- 在生产环境中考虑对配置文件进行加密处理


---

**分析置信度**: 9.5/10
